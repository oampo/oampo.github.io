!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var n=r(1),i=n.vec3,o=n.mat4,a=r(11);r(28);var s=r(29),u=function(t){a.App.call(this,t),this.lastUpdateTime=null,this.timestep=1/60,this.accum=0,this.createAudio(),this.createFlock(),this.setBlending(),this.createRenderers(),this.createCachedVectors()};u.prototype=Object.create(a.App.prototype),u.prototype.constructor=u,u.prototype.createFlock=function(){var t=[screen.width,screen.height,(screen.width+screen.height)/2];this.flock=new s(15,t,this.audioContext)},u.prototype.setBlending=function(){gl.enable(gl.BLEND),gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA)},u.prototype.createRenderers=function(){var t=document.getElementById("point-sprite-vert").textContent,e=document.getElementById("point-sprite-frag").textContent;this.flockRenderer=new a.FramebufferRenderer(screen.width,screen.height,t,e),this.projectionMatrix=o.create(),this.modelviewMatrix=o.create(),this.litTexture=new a.Texture(720,720),this.litTexture.loadFromFile("lit.png"),this.blurRenderers=[],this.blurMeshes=[],this.blurProjectionMatrices=[],this.blurModelviewMatrix=o.create();for(var t=document.getElementById("texture-vert").textContent,e=document.getElementById("blur-frag").textContent,r=0;3>r;r++){var n=screen.width>>r+1,i=screen.height>>r+1,s=new a.FramebufferRenderer(n,i,t,e);s.setUniform("uOffset",[1/n,1/i]);var u=new a.RectMesh(n,i,gl.STATIC_DRAW,null,null,gl.STATIC_DRAW),c=o.create();o.ortho(c,0,n,i,0,-1,1),s.setUniform("uProjectionMatrix",c),s.setUniform("uModelviewMatrix",this.blurModelviewMatrix),this.blurRenderers.push(s),this.blurMeshes.push(u),this.blurProjectionMatrices.push(c)}var t=document.getElementById("texture-vert").textContent,e=document.getElementById("blend-frag").textContent;this.blendRenderer=new a.BasicRenderer(t,e);for(var r=0;r<this.blurRenderers.length;r++)this.blendRenderer.setUniform("uSampler"+r,r);this.orthoProjectionMatrix=o.create(),o.ortho(this.orthoProjectionMatrix,0,1,1,0,-1,1),this.blendRenderer.setUniform("uProjectionMatrix",this.orthoProjectionMatrix),this.orthoModelviewMatrix=o.create(),this.blendRenderer.setUniform("uModelviewMatrix",this.orthoModelviewMatrix),this.textureMesh=new a.RectMesh(1,1,gl.STATIC_DRAW,null,null,gl.STATIC_DRAW)},u.prototype.createCachedVectors=function(){this.target=i.create(),this.eye=i.create()},u.prototype.createAudio=function(){this.audioContext=new AudioContext},u.prototype.runUpdates=function(){null==this.lastUpdateTime&&(this.lastUpdateTime=Date.now());var t=Date.now(),e=(t-this.lastUpdateTime)/1e3;for(this.lastUpdateTime=t,this.accum+=e;this.accum>=this.timestep;)this.update(this.timestep),this.accum-=this.timestep},u.prototype.update=function(t){this.flock.update(t)},u.prototype.draw=function(){this.updateViewport(),this.runUpdates(),this.setTransformationMatrices(),this.flock.updateMesh(),this.flock.updateAudio(this.modelviewMatrix),this.flockRenderer.framebuffer.clear([0,0,0,1]),this.litTexture.begin(),this.flockRenderer.render(this.flock.mesh),this.litTexture.end();for(var t=0;t<this.blurRenderers.length;t++){var e=this.blurRenderers[t];0==t?this.flockRenderer.framebuffer.texture.begin():this.blurRenderers[t-1].framebuffer.texture.begin(),e.render(this.blurMeshes[t]),0==t?this.flockRenderer.framebuffer.texture.end():this.blurRenderers[t-1].framebuffer.texture.end()}for(var t=0;t<this.blurRenderers.length;t++)this.blurRenderers[t].framebuffer.texture.begin(t);this.blendRenderer.render(this.textureMesh);for(var t=0;t<this.blurRenderers.length;t++)this.blurRenderers[t].framebuffer.texture.end();window.requestAnimationFrame(this.draw.bind(this))},u.prototype.setTransformationMatrices=function(){o.perspective(this.projectionMatrix,Math.PI/3,this.canvas.width/this.canvas.height,1e-6,1e4),i.copy(this.eye,this.flock.boids[0].position),i.copy(this.target,this.flock.center()),o.lookAt(this.modelviewMatrix,this.eye,this.target,[0,1,0]),this.flockRenderer.setUniform("uProjectionMatrix",this.projectionMatrix),this.flockRenderer.setUniform("uModelviewMatrix",this.modelviewMatrix),this.flockRenderer.setUniform("uCameraPosition",this.flock.boids[0].position)},document.addEventListener("DOMContentLoaded",function(){window.app=new u({canvas:document.getElementById("main-canvas")}),window.requestAnimationFrame(window.app.draw.bind(window.app))})},function(t,e,r){e.glMatrix=r(2),e.mat2=r(3),e.mat2d=r(4),e.mat3=r(5),e.mat4=r(6),e.quat=r(7),e.vec2=r(10),e.vec3=r(8),e.vec4=r(9)},function(t,e){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var n=Math.PI/180;r.toRadian=function(t){return t*n},t.exports=r},function(t,e,r){var n=r(2),i={};i.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*o-i*n;return a?(a=1/a,t[0]=o*a,t[1]=-n*a,t[2]=-i*a,t[3]=r*a,t):null},i.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=r[0],u=r[1],c=r[2],h=r[3];return t[0]=n*s+o*u,t[1]=i*s+a*u,t[2]=n*c+o*h,t[3]=i*c+a*h,t},i.mul=i.multiply,i.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=i*u+a*s,t[2]=n*-s+o*u,t[3]=i*-s+a*u,t},i.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=r[0],u=r[1];return t[0]=n*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},t.exports=i},function(t,e,r){var n=r(2),i={};i.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=r*o-n*i;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-i*u,t[3]=r*u,t[4]=(i*s-o*a)*u,t[5]=(n*a-r*s)*u,t):null},i.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=r[0],h=r[1],f=r[2],l=r[3],p=r[4],d=r[5];return t[0]=n*c+o*h,t[1]=i*c+a*h,t[2]=n*f+o*l,t[3]=i*f+a*l,t[4]=n*p+o*d+s,t[5]=i*p+a*d+u,t},i.mul=i.multiply,i.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=Math.sin(r),h=Math.cos(r);return t[0]=n*h+o*c,t[1]=i*h+a*c,t[2]=n*-c+o*h,t[3]=i*-c+a*h,t[4]=s,t[5]=u,t},i.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=r[0],h=r[1];return t[0]=n*c,t[1]=i*c,t[2]=o*h,t[3]=a*h,t[4]=s,t[5]=u,t},i.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=r[0],h=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=n*c+o*h+s,t[5]=i*c+a*h+u,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},i.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},t.exports=i},function(t,e,r){var n=r(2),i={};i.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},i.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=h*a-s*c,l=-h*o+s*u,p=c*o-a*u,d=r*f+n*l+i*p;return d?(d=1/d,t[0]=f*d,t[1]=(-h*n+i*c)*d,t[2]=(s*n-i*a)*d,t[3]=l*d,t[4]=(h*r-i*u)*d,t[5]=(-s*r+i*o)*d,t[6]=p*d,t[7]=(-c*r+n*u)*d,t[8]=(a*r-n*o)*d,t):null},i.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8];return t[0]=a*h-s*c,t[1]=i*c-n*h,t[2]=n*s-i*a,t[3]=s*u-o*h,t[4]=r*h-i*u,t[5]=i*o-r*s,t[6]=o*c-a*u,t[7]=n*u-r*c,t[8]=r*a-n*o,t},i.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-a*u)+r*(-c*i+a*s)+n*(u*i-o*s)},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=r[0],p=r[1],d=r[2],g=r[3],m=r[4],v=r[5],M=r[6],b=r[7],A=r[8];return t[0]=l*n+p*a+d*c,t[1]=l*i+p*s+d*h,t[2]=l*o+p*u+d*f,t[3]=g*n+m*a+v*c,t[4]=g*i+m*s+v*h,t[5]=g*o+m*u+v*f,t[6]=M*n+b*a+A*c,t[7]=M*i+b*s+A*h,t[8]=M*o+b*u+A*f,t},i.mul=i.multiply,i.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=r[0],p=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l*n+p*a+c,t[7]=l*i+p*s+h,t[8]=l*o+p*u+f,t},i.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=Math.sin(r),p=Math.cos(r);return t[0]=p*n+l*a,t[1]=p*i+l*s,t[2]=p*o+l*u,t[3]=p*a-l*n,t[4]=p*s-l*i,t[5]=p*u-l*o,t[6]=c,t[7]=h,t[8]=f,t},i.scale=function(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},i.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,s=n+n,u=i+i,c=r*a,h=n*a,f=n*s,l=i*a,p=i*s,d=i*u,g=o*a,m=o*s,v=o*u;return t[0]=1-f-d,t[3]=h-v,t[6]=l+m,t[1]=h+v,t[4]=1-c-d,t[7]=p-g,t[2]=l-m,t[5]=p+g,t[8]=1-c-f,t},i.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],p=e[11],d=e[12],g=e[13],m=e[14],v=e[15],M=r*s-n*a,b=r*u-i*a,A=r*c-o*a,R=n*u-i*s,E=n*c-o*s,T=i*c-o*u,y=h*g-f*d,x=h*m-l*d,F=h*v-p*d,w=f*m-l*g,_=f*v-p*g,P=l*v-p*m,S=M*P-b*_+A*w+R*F-E*x+T*y;return S?(S=1/S,t[0]=(s*P-u*_+c*w)*S,t[1]=(u*F-a*P-c*x)*S,t[2]=(a*_-s*F+c*y)*S,t[3]=(i*_-n*P-o*w)*S,t[4]=(r*P-i*F+o*x)*S,t[5]=(n*F-r*_-o*y)*S,t[6]=(g*T-m*E+v*R)*S,t[7]=(m*A-d*T-v*b)*S,t[8]=(d*E-g*A+v*M)*S,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},t.exports=i},function(t,e,r){var n=r(2),i={};i.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],p=e[11],d=e[12],g=e[13],m=e[14],v=e[15],M=r*s-n*a,b=r*u-i*a,A=r*c-o*a,R=n*u-i*s,E=n*c-o*s,T=i*c-o*u,y=h*g-f*d,x=h*m-l*d,F=h*v-p*d,w=f*m-l*g,_=f*v-p*g,P=l*v-p*m,S=M*P-b*_+A*w+R*F-E*x+T*y;return S?(S=1/S,t[0]=(s*P-u*_+c*w)*S,t[1]=(i*_-n*P-o*w)*S,t[2]=(g*T-m*E+v*R)*S,t[3]=(l*E-f*T-p*R)*S,t[4]=(u*F-a*P-c*x)*S,t[5]=(r*P-i*F+o*x)*S,t[6]=(m*A-d*T-v*b)*S,t[7]=(h*T-l*A+p*b)*S,t[8]=(a*_-s*F+c*y)*S,t[9]=(n*F-r*_-o*y)*S,t[10]=(d*E-g*A+v*M)*S,t[11]=(f*A-h*E-p*M)*S,t[12]=(s*x-a*w-u*y)*S,t[13]=(r*w-n*x+i*y)*S,t[14]=(g*b-d*R-m*M)*S,t[15]=(h*R-f*b+l*M)*S,t):null},i.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],p=e[11],d=e[12],g=e[13],m=e[14],v=e[15];return t[0]=s*(l*v-p*m)-f*(u*v-c*m)+g*(u*p-c*l),t[1]=-(n*(l*v-p*m)-f*(i*v-o*m)+g*(i*p-o*l)),t[2]=n*(u*v-c*m)-s*(i*v-o*m)+g*(i*c-o*u),t[3]=-(n*(u*p-c*l)-s*(i*p-o*l)+f*(i*c-o*u)),t[4]=-(a*(l*v-p*m)-h*(u*v-c*m)+d*(u*p-c*l)),t[5]=r*(l*v-p*m)-h*(i*v-o*m)+d*(i*p-o*l),t[6]=-(r*(u*v-c*m)-a*(i*v-o*m)+d*(i*c-o*u)),t[7]=r*(u*p-c*l)-a*(i*p-o*l)+h*(i*c-o*u),t[8]=a*(f*v-p*g)-h*(s*v-c*g)+d*(s*p-c*f),t[9]=-(r*(f*v-p*g)-h*(n*v-o*g)+d*(n*p-o*f)),t[10]=r*(s*v-c*g)-a*(n*v-o*g)+d*(n*c-o*s),t[11]=-(r*(s*p-c*f)-a*(n*p-o*f)+h*(n*c-o*s)),t[12]=-(a*(f*m-l*g)-h*(s*m-u*g)+d*(s*l-u*f)),t[13]=r*(f*m-l*g)-h*(n*m-i*g)+d*(n*l-i*f),t[14]=-(r*(s*m-u*g)-a*(n*m-i*g)+d*(n*u-i*s)),t[15]=r*(s*l-u*f)-a*(n*l-i*f)+h*(n*u-i*s),t},i.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],p=t[12],d=t[13],g=t[14],m=t[15],v=e*a-r*o,M=e*s-n*o,b=e*u-i*o,A=r*s-n*a,R=r*u-i*a,E=n*u-i*s,T=c*d-h*p,y=c*g-f*p,x=c*m-l*p,F=h*g-f*d,w=h*m-l*d,_=f*m-l*g;return v*_-M*w+b*F+A*x-R*y+E*T},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],p=e[10],d=e[11],g=e[12],m=e[13],v=e[14],M=e[15],b=r[0],A=r[1],R=r[2],E=r[3];return t[0]=b*n+A*s+R*f+E*g,t[1]=b*i+A*u+R*l+E*m,t[2]=b*o+A*c+R*p+E*v,t[3]=b*a+A*h+R*d+E*M,b=r[4],A=r[5],R=r[6],E=r[7],t[4]=b*n+A*s+R*f+E*g,t[5]=b*i+A*u+R*l+E*m,t[6]=b*o+A*c+R*p+E*v,t[7]=b*a+A*h+R*d+E*M,b=r[8],A=r[9],R=r[10],E=r[11],t[8]=b*n+A*s+R*f+E*g,t[9]=b*i+A*u+R*l+E*m,t[10]=b*o+A*c+R*p+E*v,t[11]=b*a+A*h+R*d+E*M,b=r[12],A=r[13],R=r[14],E=r[15],t[12]=b*n+A*s+R*f+E*g,t[13]=b*i+A*u+R*l+E*m,t[14]=b*o+A*c+R*p+E*v,t[15]=b*a+A*h+R*d+E*M,t},i.mul=i.multiply,i.translate=function(t,e,r){var n,i,o,a,s,u,c,h,f,l,p,d,g=r[0],m=r[1],v=r[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*v+e[12],t[13]=e[1]*g+e[5]*m+e[9]*v+e[13],t[14]=e[2]*g+e[6]*m+e[10]*v+e[14],t[15]=e[3]*g+e[7]*m+e[11]*v+e[15]):(n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],p=e[10],d=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=l,t[10]=p,t[11]=d,t[12]=n*g+s*m+f*v+e[12],t[13]=i*g+u*m+l*v+e[13],t[14]=o*g+c*m+p*v+e[14],t[15]=a*g+h*m+d*v+e[15]),t},i.scale=function(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.rotate=function(t,e,r,i){var o,a,s,u,c,h,f,l,p,d,g,m,v,M,b,A,R,E,T,y,x,F,w,_,P=i[0],S=i[1],L=i[2],B=Math.sqrt(P*P+S*S+L*L);return Math.abs(B)<n.EPSILON?null:(B=1/B,P*=B,S*=B,L*=B,o=Math.sin(r),a=Math.cos(r),s=1-a,u=e[0],c=e[1],h=e[2],f=e[3],l=e[4],p=e[5],d=e[6],g=e[7],m=e[8],v=e[9],M=e[10],b=e[11],A=P*P*s+a,R=S*P*s+L*o,E=L*P*s-S*o,T=P*S*s-L*o,y=S*S*s+a,x=L*S*s+P*o,F=P*L*s+S*o,w=S*L*s-P*o,_=L*L*s+a,t[0]=u*A+l*R+m*E,t[1]=c*A+p*R+v*E,t[2]=h*A+d*R+M*E,t[3]=f*A+g*R+b*E,t[4]=u*T+l*y+m*x,t[5]=c*T+p*y+v*x,t[6]=h*T+d*y+M*x,t[7]=f*T+g*y+b*x,t[8]=u*F+l*w+m*_,t[9]=c*F+p*w+v*_,t[10]=h*F+d*w+M*_,t[11]=f*F+g*w+b*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},i.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*n,t[5]=a*i+h*n,t[6]=s*i+f*n,t[7]=u*i+l*n,t[8]=c*i-o*n,t[9]=h*i-a*n,t[10]=f*i-s*n,t[11]=l*i-u*n,t},i.rotateY=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*n,t[1]=a*i-h*n,t[2]=s*i-f*n,t[3]=u*i-l*n,t[8]=o*n+c*i,t[9]=a*n+h*i,t[10]=s*n+f*i,t[11]=u*n+l*i,t},i.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*n,t[1]=a*i+h*n,t[2]=s*i+f*n,t[3]=u*i+l*n,t[4]=c*i-o*n,t[5]=h*i-a*n,t[6]=f*i-s*n,t[7]=l*i-u*n,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,e,r){var i,o,a,s=r[0],u=r[1],c=r[2],h=Math.sqrt(s*s+u*u+c*c);return Math.abs(h)<n.EPSILON?null:(h=1/h,s*=h,u*=h,c*=h,i=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+c*i,t[2]=c*s*a-u*i,t[3]=0,t[4]=s*u*a-c*i,t[5]=u*u*a+o,t[6]=c*u*a+s*i,t[7]=0,t[8]=s*c*a+u*i,t[9]=u*c*a-s*i,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=n+n,u=i+i,c=o+o,h=n*s,f=n*u,l=n*c,p=i*u,d=i*c,g=o*c,m=a*s,v=a*u,M=a*c;return t[0]=1-(p+g),t[1]=f+M,t[2]=l-v,t[3]=0,t[4]=f-M,t[5]=1-(h+g),t[6]=d+m,t[7]=0,t[8]=l+v,t[9]=d-m,t[10]=1-(h+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},i.fromRotationTranslationScale=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,h=a+a,f=i*u,l=i*c,p=i*h,d=o*c,g=o*h,m=a*h,v=s*u,M=s*c,b=s*h,A=n[0],R=n[1],E=n[2];return t[0]=(1-(d+m))*A,t[1]=(l+b)*A,t[2]=(p-M)*A,t[3]=0,t[4]=(l-b)*R,t[5]=(1-(f+m))*R,t[6]=(g+v)*R,t[7]=0,t[8]=(p+M)*E,t[9]=(g-v)*E,t[10]=(1-(f+d))*E,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,e,r,n,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,h=a+a,f=s+s,l=o*c,p=o*h,d=o*f,g=a*h,m=a*f,v=s*f,M=u*c,b=u*h,A=u*f,R=n[0],E=n[1],T=n[2],y=i[0],x=i[1],F=i[2];return t[0]=(1-(g+v))*R,t[1]=(p+A)*R,t[2]=(d-b)*R,t[3]=0,t[4]=(p-A)*E,t[5]=(1-(l+v))*E,t[6]=(m+M)*E,t[7]=0,t[8]=(d+b)*T,t[9]=(m-M)*T,t[10]=(1-(l+g))*T,t[11]=0,t[12]=r[0]+y-(t[0]*y+t[4]*x+t[8]*F),t[13]=r[1]+x-(t[1]*y+t[5]*x+t[9]*F),t[14]=r[2]+F-(t[2]*y+t[6]*x+t[10]*F),t[15]=1,t},i.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,s=n+n,u=i+i,c=r*a,h=n*a,f=n*s,l=i*a,p=i*s,d=i*u,g=o*a,m=o*s,v=o*u;return t[0]=1-f-d,t[1]=h+v,t[2]=l-m,t[3]=0,t[4]=h-v,t[5]=1-c-d,t[6]=p+g,t[7]=0,t[8]=l+m,t[9]=p-g,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,e,r,n,i,o,a){var s=1/(r-e),u=1/(i-n),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},i.perspective=function(t,e,r,n,i){var o=1/Math.tan(e/2),a=1/(n-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*a,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((a-s)*u*.5),t[9]=(i-o)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},i.ortho=function(t,e,r,n,i,o,a){var s=1/(e-r),u=1/(n-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*u,t[14]=(a+o)*c,t[15]=1,t},i.lookAt=function(t,e,r,o){var a,s,u,c,h,f,l,p,d,g,m=e[0],v=e[1],M=e[2],b=o[0],A=o[1],R=o[2],E=r[0],T=r[1],y=r[2];return Math.abs(m-E)<n.EPSILON&&Math.abs(v-T)<n.EPSILON&&Math.abs(M-y)<n.EPSILON?i.identity(t):(l=m-E,p=v-T,d=M-y,g=1/Math.sqrt(l*l+p*p+d*d),l*=g,p*=g,d*=g,a=A*d-R*p,s=R*l-b*d,u=b*p-A*l,g=Math.sqrt(a*a+s*s+u*u),g?(g=1/g,a*=g,s*=g,u*=g):(a=0,s=0,u=0),c=p*u-d*s,h=d*a-l*u,f=l*s-p*a,g=Math.sqrt(c*c+h*h+f*f),g?(g=1/g,c*=g,h*=g,f*=g):(c=0,h=0,f=0),t[0]=a,t[1]=c,t[2]=l,t[3]=0,t[4]=s,t[5]=h,t[6]=p,t[7]=0,t[8]=u,t[9]=f,t[10]=d,t[11]=0,t[12]=-(a*m+s*v+u*M),t[13]=-(c*m+h*v+f*M),t[14]=-(l*m+p*v+d*M),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},t.exports=i},function(t,e,r){var n=r(2),i=r(5),o=r(8),a=r(9),s={};s.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(n,i,a){var u=o.dot(i,a);return-.999999>u?(o.cross(t,e,i),o.length(t)<1e-6&&o.cross(t,r,i),o.normalize(t,t),s.setAxisAngle(n,t,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,i,a),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+u,s.normalize(n,n))}}(),s.setAxes=function(){var t=i.create();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,r){r=.5*r;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},s.add=a.add,s.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=r[0],u=r[1],c=r[2],h=r[3];return t[0]=n*h+a*s+i*c-o*u,t[1]=i*h+a*u+o*s-n*c,t[2]=o*h+a*c+n*u-i*s,t[3]=a*h-n*s-i*u-o*c,t},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-n*s,t},s.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-o*s,t[1]=i*u+a*s,t[2]=o*u+n*s,t[3]=a*u-i*s,t},s.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=i*u-n*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},s.calculateW=function(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(t,e,r,n){var i,o,a,s,u,c=e[0],h=e[1],f=e[2],l=e[3],p=r[0],d=r[1],g=r[2],m=r[3];return o=c*p+h*d+f*g+l*m,0>o&&(o=-o,p=-p,d=-d,g=-g,m=-m),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-n)*i)/a,u=Math.sin(n*i)/a):(s=1-n,u=n),t[0]=s*c+u*p,t[1]=s*h+u*d,t[2]=s*f+u*g,t[3]=s*l+u*m,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(r,n,i,o,a,u){return s.slerp(t,n,a,u),s.slerp(e,i,o,u),s.slerp(r,t,e,2*u*(1-u)),r}}(),s.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o,s=a?1/a:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-i*s,t[3]=o*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*o+a]-e[3*a+o])*r,t[o]=(e[3*o+i]+e[3*i+o])*r,t[a]=(e[3*a+i]+e[3*i+a])*r}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=s},function(t,e,r){var n=r(2),i={};i.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,r){var i=new n.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=r,i},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],u=r[2];return t[0]=i*u-o*s,t[1]=o*a-n*u,t[2]=n*s-i*a,t},i.lerp=function(t,e,r,n){var i=e[0],o=e[1],a=e[2];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t},i.hermite=function(t,e,r,n,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*s+r[0]*u+n[0]*c+i[0]*h,t[1]=e[1]*s+r[1]*u+n[1]*c+i[1]*h,t[2]=e[2]*s+r[2]*u+n[2]*c+i[2]*h,t},i.bezier=function(t,e,r,n,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,h=3*o*s,f=3*u*a,l=u*o;return t[0]=e[0]*c+r[0]*h+n[0]*f+i[0]*l,t[1]=e[1]*c+r[1]*h+n[1]*f+i[1]*l,t[2]=e[2]*c+r[2]*h+n[2]*f+i[2]*l,t},i.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,i=2*n.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=i*e,t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,t},i.transformMat3=function(t,e,r){var n=e[0],i=e[1],o=e[2];return t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8],t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],u=r[2],c=r[3],h=c*n+s*o-u*i,f=c*i+u*n-a*o,l=c*o+a*i-s*n,p=-a*n-s*i-u*o;return t[0]=h*c+p*-a+f*-u-l*-s,t[1]=f*c+p*-s+l*-a-h*-u,t[2]=l*c+p*-u+h*-s-f*-a,t},i.rotateX=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.rotateY=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.rotateZ=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var s,u;for(r||(r=3),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),i.angle=function(t,e){var r=i.fromValues(t[0],t[1],t[2]),n=i.fromValues(e[0],e[1],e[2]);i.normalize(r,r),i.normalize(n,n);var o=i.dot(r,n);return o>1?0:Math.acos(o)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t.exports=i},function(t,e,r){var n=r(2),i={};i.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.fromValues=function(t,e,r,i){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},
i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=s+n*(r[3]-s),t},i.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],u=r[2],c=r[3],h=c*n+s*o-u*i,f=c*i+u*n-a*o,l=c*o+a*i-s*n,p=-a*n-s*i-u*o;return t[0]=h*c+p*-a+f*-u-l*-s,t[1]=f*c+p*-s+l*-a-h*-u,t[2]=l*c+p*-u+h*-s-f*-a,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var s,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=i},function(t,e,r){var n=r(2),i={};i.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,r){return t[0]=e,t[1]=r,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},i.lerp=function(t,e,r,n){var i=e[0],o=e[1];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t},i.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},i.transformMat2=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t},i.transformMat2d=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t},i.transformMat3=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var s,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t.exports=i},function(t,e,r){e.App=r(12).App,e.Attribute=r(15).Attribute,e.BasicRenderer=r(16).BasicRenderer,e.Buffer=r(20).Buffer,e.Framebuffer=r(21).Framebuffer,e.FramebufferRenderer=r(23).FramebufferRenderer,e.MatrixStack=r(24).MatrixStack,e.Mesh=r(25).Mesh,e.RectMesh=r(26).RectMesh,e.Shader=r(18).Shader,e.ShaderProgram=r(17).ShaderProgram,e.Texture=r(22).Texture,e.Transformation=r(27).Transformation,e.Uniform=r(19).Uniform,e.glMatrix=r(1)},function(t,e,r){(function(t){var n=r(13).WebGLDebugUtils,i=r(14),o=function(e){e=e||{},this.canvas=e.canvas;var r=e.contextAttributes||{};try{t.gl=this.canvas.getContext("webgl",r)||this.canvas.getContext("experimental-webgl",e.contextAttributes),gl=i.monkeyPatchViewport(gl),e.debug&&(gl=n.makeDebugContext(gl))}catch(o){gl=null}};o.prototype.updateViewport=function(){this.canvas.clientWidth&&this.canvas.clientHeight&&(this.canvas.width!=this.canvas.clientWidth||this.canvas.height!=this.canvas.clientHeight)&&(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight),gl.viewport(0,0,this.canvas.width,this.canvas.height)},o.prototype.getCanvasPosition=function(){var t=vec2.create(),e=this.canvas;do vec2[0]+=e.offsetLeft,vec2[1]+=e.offsetTop;while(e=e.offsetParent);return t},e.App=o}).call(e,function(){return this}())},function(t,e){WebGLDebugUtils=function(){function t(t){if(null==p){p={},d={};for(var e in t)"number"==typeof t[e]&&(p[t[e]]=e,d[e]=t[e])}}function e(){if(null==p)throw"WebGLDebugUtils.init(ctx) not called"}function r(t){return e(),void 0!==p[t]}function n(t){e();var r=p[t];return void 0!==r?"gl."+r:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function i(t,e,r,i){var o=l[t];if(void 0!==o){var o=o[e];if(void 0!==o&&o[r]){if("object"==typeof o[r]&&void 0!==o[r].enumBitwiseOr){for(var a=o[r].enumBitwiseOr,s=0,u=[],c=0;c<a.length;++c){var h=d[a[c]];0!==(i&h)&&(s|=h,u.push(n(h)))}return s===i?u.join(" | "):n(i)}return n(i)}}return null===i?"null":void 0===i?"undefined":i.toString()}function o(t,e){for(var r="",n=e.length,o=0;n>o;++o)r+=(0==o?"":", ")+i(t,n,o,e[o]);return r}function a(t,e,r){t.__defineGetter__(r,function(){return e[r]}),t.__defineSetter__(r,function(t){e[r]=t})}function s(e,r,o,u){function c(t,e){return function(){o&&o(e,arguments);var n=t[e].apply(t,arguments),i=u.getError();return 0!=i&&(h[i]=!0,r(i,e,arguments)),n}}u=u||e,t(e),r=r||function(t,e,r){for(var o="",a=r.length,s=0;a>s;++s)o+=(0==s?"":", ")+i(e,a,s,r[s]);f("WebGL error "+n(t)+" in "+e+"("+o+")")};var h={},l={};for(var p in e)if("function"==typeof e[p])if("getExtension"!=p)l[p]=c(e,p);else{var d=c(e,p);l[p]=function(){var t=d.apply(e,arguments);return s(t,r,o,u)}}else a(l,e,p);return l.getError=function(){for(var t in h)if(h.hasOwnProperty(t)&&h[t])return h[t]=!1,t;return e.NO_ERROR},l}function u(t){var e=t.getParameter(t.MAX_VERTEX_ATTRIBS),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r);for(var n=0;e>n;++n)t.disableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(n,0);t.deleteBuffer(r);for(var i=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),n=0;i>n;++n)t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null);for(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT);t.getError(););}function c(t){function e(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}function r(t){var e=t.addEventListener;t.addEventListener=function(r,n,i){switch(r){case"webglcontextlost":T(n);break;case"webglcontextrestored":y(n);break;default:e.apply(t,arguments)}}}function n(){for(var t=Object.keys(E),e=0;e<t.length;++e)delete E[t]}function i(){++b,m||M==b&&t.loseContext()}function o(t,e){var r=t[e];return function(){if(i(),!m){var e=r.apply(t,arguments);return e}}}function s(){for(var t=0;t<v.length;++t){var e=v[t];e instanceof WebGLBuffer?f.deleteBuffer(e):e instanceof WebGLFramebuffer?f.deleteFramebuffer(e):e instanceof WebGLProgram?f.deleteProgram(e):e instanceof WebGLRenderbuffer?f.deleteRenderbuffer(e):e instanceof WebGLShader?f.deleteShader(e):e instanceof WebGLTexture&&f.deleteTexture(e)}}function c(t){return{statusMessage:t,preventDefault:function(){A=!0}}}function h(t){for(var e in t)"function"==typeof t[e]?l[e]=o(t,e):a(l,t,e);l.getError=function(){if(i(),!m)for(var t;t=f.getError();)E[t]=!0;for(var t in E)if(E[t])return delete E[t],t;return l.NO_ERROR};for(var r=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],n=0;n<r.length;++n){var s=r[n];l[s]=function(e){return function(){if(i(),m)return null;var r=e.apply(t,arguments);return r.__webglDebugContextLostId__=g,v.push(r),r}}(t[s])}for(var u=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],n=0;n<u.length;++n){var s=u[n];l[s]=function(e){return function(){return i(),m?null:e.apply(t,arguments)}}(l[s])}for(var c=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],n=0;n<c.length;++n){var s=c[n];l[s]=function(e){return function(){return i(),m?!1:e.apply(t,arguments)}}(l[s])}return l.checkFramebufferStatus=function(e){return function(){return i(),m?l.FRAMEBUFFER_UNSUPPORTED:e.apply(t,arguments)}}(l.checkFramebufferStatus),l.getAttribLocation=function(e){return function(){return i(),m?-1:e.apply(t,arguments)}}(l.getAttribLocation),l.getVertexAttribOffset=function(e){return function(){return i(),m?0:e.apply(t,arguments)}}(l.getVertexAttribOffset),l.isContextLost=function(){return m},l}var f,l,p=[],d=[],l={},g=1,m=!1,v=[],M=0,b=0,A=!1,R=0,E={};t.getContext=function(e){return function(){var r=e.apply(t,arguments);if(r instanceof WebGLRenderingContext){if(r!=f){if(f)throw"got different context";f=r,l=h(f)}return l}return r}}(t.getContext);var T=function(t){p.push(e(t))},y=function(t){d.push(e(t))};return r(t),t.loseContext=function(){if(!m){for(m=!0,M=0,++g;f.getError(););n(),E[f.CONTEXT_LOST_WEBGL]=!0;var e=c("context lost"),r=p.slice();setTimeout(function(){for(var n=0;n<r.length;++n)r[n](e);R>=0&&setTimeout(function(){t.restoreContext()},R)},0)}},t.restoreContext=function(){m&&d.length&&setTimeout(function(){if(!A)throw"can not restore. webglcontestlost listener did not call event.preventDefault";s(),u(f),m=!1,b=0,A=!1;for(var t=d.slice(),e=c("context restored"),r=0;r<t.length;++r)t[r](e)},0)},t.loseContextInNCalls=function(t){if(m)throw"You can not ask a lost contet to be lost";M=b+t},t.getNumCalls=function(){return b},t.setRestoreTimeout=function(t){R=t},t}var h=function(t){window.console&&window.console.log&&window.console.log(t)},f=function(t){window.console&&window.console.error?window.console.error(t):h(t)},l={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},p=null,d=null;return{init:t,mightBeEnum:r,glEnumToString:n,glFunctionArgToString:i,glFunctionArgsToString:o,makeDebugContext:s,makeLostContextSimulatingCanvas:c,resetToInitialState:u}}(),e.WebGLDebugUtils=WebGLDebugUtils},function(t,e){e.monkeyPatchViewport=function(t){var e=t.viewport;return t.viewport=function(r,n,i,o){t.currentViewport=[r,n,i,o],e(r,n,i,o)},t}},function(t,e){var r=function(t,e){this.size=t.size,this.type=t.type,this.name=t.name,this.location=gl.getAttribLocation(e,this.name),this.createFunctionHashes(),this.createSizeHash()};r.prototype.createFunctionHashes=function(){this.floatFunctions={},this.floatFunctions[gl.FLOAT]=gl.vertexAttrib1fv,this.floatFunctions[gl.FLOAT_VEC2]=gl.vertexAttrib2fv,this.floatFunctions[gl.FLOAT_VEC3]=gl.vertexAttrib3fv,this.floatFunctions[gl.FLOAT_VEC4]=gl.vertexAttrib4fv,this.matrixFunctions={},this.matrixFunctions[gl.FLOAT_MAT2]=gl.vertexAttrib2fv,this.matrixFunctions[gl.FLOAT_MAT3]=gl.vertexAttrib3fv,this.matrixFunctions[gl.FLOAT_MAT4]=gl.vertexAttrib4fv},r.prototype.createSizeHash=function(){this.sizes={},this.sizes[gl.FLOAT]=1,this.sizes[gl.FLOAT_VEC2]=2,this.sizes[gl.FLOAT_VEC3]=3,this.sizes[gl.FLOAT_VEC4]=4,this.sizes[gl.FLOAT_MAT2]=4,this.sizes[gl.FLOAT_MAT3]=9,this.sizes[gl.FLOAT_MAT4]=16},r.prototype.setValue=function(t){"number"==typeof t&&(t=[t]),this.floatFunctions[this.type]?this.setFloat(t):this.matrixFunctions[this.type]&&this.setMatrix(t)},r.prototype.setFloat=function(t){this.floatFunctions[this.type].apply(gl,[this.location,t])},r.prototype.setMatrix=function(t){this.matrixFunctions[this.type].apply(gl,[this.location,t])},r.prototype.setPointer=function(){gl.enableVertexAttribArray(this.location),gl.vertexAttribPointer(this.location,this.sizes[this.type],gl.FLOAT,!1,0,0)},e.Attribute=r},function(t,e,r){var n=r(17).ShaderProgram,i=function(t,e){this.shaderProgram=new n,this.shaderProgram.addShader(t,gl.VERTEX_SHADER),this.shaderProgram.addShader(e,gl.FRAGMENT_SHADER),this.shaderProgram.use()};i.prototype.render=function(t,e,r){this.shaderProgram.use(),t.associate(this.shaderProgram),t.render(e,r)},i.prototype.setUniform=function(t,e){this.shaderProgram.setUniform(t,e)},e.BasicRenderer=i},function(t,e,r){var n=r(18).Shader,i=r(15).Attribute,o=r(19).Uniform,a=function(){this.id=a.id,a.id+=1,this.program=null,this.shaders=[],this.uniforms={},this.attributes={},this.needRecompile=!0};a.id=0,a.prototype.addShader=function(t,e){var r=new n(t,e);return this.shaders.push(r),this.needRecompile=!0,r},a.prototype.removeShader=function(t){var e=this.shaders.indexOf(t);-1!=e&&this.shaders.splice(e,1),this.needRecompile=!0},a.prototype.createProgram=function(){this.program=gl.createProgram()},a.prototype.deleteProgram=function(){gl.deleteProgram(this.program)},a.prototype.attachShaders=function(){for(var t=0;t<this.shaders.length;t++){var e=this.shaders[t];gl.attachShader(this.program,e.getShader())}},a.prototype.getAttributes=function(){var t=gl.getProgramParameter(this.program,gl.ACTIVE_ATTRIBUTES);console.log("Program %d has %d active attributes",this.id,t);for(var e=0;t>e;e++){var r=gl.getActiveAttrib(this.program,e),n=new i(r,this.program);this.attributes[n.name]=n,console.log("Attribute %d: %s",e,n.name)}},a.prototype.getUniforms=function(){var t=gl.getProgramParameter(this.program,gl.ACTIVE_UNIFORMS);console.log("Program %d has %d active uniforms",this.id,t);for(var e=0;t>e;e++){var r=gl.getActiveUniform(this.program,e),n=new o(r,this.program);this.uniforms[n.name]=n,console.log("Uniform %d: %s",e,n.name)}},a.prototype.linkProgram=function(){return gl.linkProgram(this.program),gl.getProgramParameter(this.program,gl.LINK_STATUS)?!0:(console.error("Could not link shader program, %i",this.program),!1)},a.prototype.useProgram=function(){gl.useProgram(this.program)},a.prototype.use=function(){(this.needRecompile||a.activeProgram!=this.program)&&(this.needRecompile&&(null!==this.program&&this.deleteProgram(),this.createProgram(),this.attachShaders(),this.linkProgram(),this.getAttributes(),this.getUniforms(),this.needRecompile=!1),this.useProgram(),a.activeProgram=this.program)},a.prototype.getUniform=function(t){return this.uniforms[t]},a.prototype.setUniform=function(t,e){this.use(),this.uniforms[t].setValue(e)},a.prototype.getAttribute=function(t){return this.attributes[t]},a.prototype.setAttribute=function(t,e){this.use(),this.attributes[t].setValue(e)},a.activeProgram=null,e.ShaderProgram=a},function(t,e){var r=function(t,e){this.source=t,this.type=e,this.shader=gl.createShader(this.type),gl.shaderSource(this.shader,this.source),gl.compileShader(this.shader),gl.getShaderParameter(this.shader,gl.COMPILE_STATUS)||console.error("Could not compile shader ",this.name,"\n",gl.getShaderInfoLog(this.shader))};r.prototype.getShader=function(){return this.shader},e.Shader=r},function(t,e){var r=function(t,e){this.size=t.size,this.type=t.type,this.name=t.name,this.location=gl.getUniformLocation(e,this.name),this.createFunctionHashes()};r.prototype.createFunctionHashes=function(){this.floatFunctions={},this.floatFunctions[gl.FLOAT]=gl.uniform1fv,this.floatFunctions[gl.FLOAT_VEC2]=gl.uniform2fv,this.floatFunctions[gl.FLOAT_VEC3]=gl.uniform3fv,this.floatFunctions[gl.FLOAT_VEC4]=gl.uniform4fv,this.intFunctions={},this.intFunctions[gl.INT]=gl.uniform1iv,this.intFunctions[gl.INT_VEC2]=gl.uniform2iv,this.intFunctions[gl.INT_VEC3]=gl.uniform3iv,this.intFunctions[gl.INT_VEC4]=gl.uniform4iv,this.boolFunctions={},this.boolFunctions[gl.BOOL]=gl.uniform1iv,this.boolFunctions[gl.BOOL_VEC2]=gl.uniform2iv,this.boolFunctions[gl.BOOL_VEC3]=gl.uniform3iv,this.boolFunctions[gl.BOOL_VEC4]=gl.unform4iv,this.matrixFunctions={},this.matrixFunctions[gl.FLOAT_MAT2]=gl.uniformMatrix2fv,this.matrixFunctions[gl.FLOAT_MAT3]=gl.uniformMatrix3fv,this.matrixFunctions[gl.FLOAT_MAT4]=gl.uniformMatrix4fv,this.samplerFunctions={},this.samplerFunctions[gl.SAMPLER_2D]=gl.uniform1iv,this.samplerFunctions[gl.SAMPLER_CUBE]=gl.uniform1iv},r.prototype.setValue=function(t){"number"==typeof t&&(t=[t]),this.floatFunctions[this.type]?this.setFloat(t):this.intFunctions[this.type]?this.setInt(t):this.boolFunctions[this.type]?this.setBool(t):this.matrixFunctions[this.type]?this.setMatrix(t):this.samplerFunctions[this.type]&&this.setSampler(t)},r.prototype.setFloat=function(t){this.floatFunctions[this.type].apply(gl,[this.location,t])},r.prototype.setInt=function(t){this.intFunctions[this.type].apply(gl,[this.location,t])},r.prototype.setBool=function(t){this.boolFunctions[this.type].apply(gl,[this.location,t])},r.prototype.setMatrix=function(t){this.matrixFunctions[this.type].apply(gl,[this.location,!1,t])},r.prototype.setSampler=function(t){this.samplerFunctions[this.type].apply(gl,[this.location,t])},e.Uniform=r},function(t,e){var r=function(t,e,r){this.numVertices=t,this.itemSize=e,this.usage=r,this.buffer=gl.createBuffer(),this["null"](),this.array=new Float32Array(t*e)};r.prototype.getBuffer=function(){return this.buffer},r.prototype["null"]=function(){this.bind(),gl.bufferData(gl.ARRAY_BUFFER,this.numVertices*this.itemSize*4,this.usage)},r.prototype.setValues=function(t,e,r){if(e=e||0,void 0===r&&(r=t?t.length:this.array.length),0!=r){var n=this.array.subarray(e,r);t&&n.set(t),this.bind(),gl.bufferSubData(gl.ARRAY_BUFFER,0,n)}},r.prototype.bind=function(){gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer)},r.prototype.unbind=function(){gl.bindBuffer(gl.ARRAY_BUFFER,null)},r.prototype.associate=function(t){this.bind(),t.setPointer(),this.unbind()},e.Buffer=r},function(t,e,r){var n=r(22).Texture,i=function(t,e){this.width=t,this.height=e,this.framebuffer=gl.createFramebuffer(),this.storedViewport=null,this.begin(),this.depthBuffer=gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,this.depthBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,t,e),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,this.depthBuffer),gl.bindRenderbuffer(gl.RENDERBUFFER,null),this.end(),this.texture=new n(t,e),this.attachTexture(this.texture),this.begin(),gl.checkFramebufferStatus(gl.FRAMEBUFFER)!=gl.FRAMEBUFFER_COMPLETE&&console.error("Could not create framebuffer - error ",gl.checkFramebufferStatus(gl.FRAMEBUFFER)),this.end()};i.prototype.begin=function(){this.pushViewport(),gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer)},i.prototype.end=function(){gl.bindFramebuffer(gl.FRAMEBUFFER,null),this.popViewport()},i.prototype.attachTexture=function(t){this.texture=t,this.begin(),this.texture.begin(),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.texture.getTexture(),0),this.texture.end(),this.end()},i.prototype.clear=function(t){this.begin(),gl.clearColor(t[0],t[1],t[2],t[3]),gl.clear(gl.COLOR_BUFFER_BIT),this.end()},i.prototype.pushViewport=function(){gl.currentViewport&&(this.storedViewport=gl.currentViewport),gl.viewport(0,0,this.width,this.height)},i.prototype.popViewport=function(){this.storedViewport&&(gl.viewport(this.storedViewport[0],this.storedViewport[1],this.storedViewport[2],this.storedViewport[3]),this.storedViewport=null)},e.Framebuffer=i},function(t,e){var r=function(t,e){this.texture=gl.createTexture(),this.flipped=!1,this.bind(),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,t,e,0,gl.RGBA,gl.UNSIGNED_BYTE,null),this.end()};r.prototype.begin=function(t){t||(t=0),gl.activeTexture(gl.TEXTURE0+t),this.bind()},r.prototype.bind=function(){gl.bindTexture(gl.TEXTURE_2D,this.texture)},r.prototype.end=function(){gl.bindTexture(gl.TEXTURE_2D,null)},r.prototype.getTexture=function(){return this.texture},r.prototype.flipY=function(){this.flipped||(this.bind(),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),this.end(),this.flipped=!0)},r.prototype.loadFromFile=function(t){var e=new Image;e.src=t,e.onload=this.loadFromExisting.bind(this,e)},r.prototype.loadFromExisting=function(t){this.image=t,this.flipY(),this.bind(),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,this.image),this.end()},e.Texture=r},function(t,e,r){var n=r(21).Framebuffer,i=r(16).BasicRenderer,o=function(t,e,r,o){i.call(this,r,o),this.framebuffer=new n(t,e)};o.prototype=Object.create(i.prototype),o.prototype.constructor=o,o.prototype.render=function(t,e,r){this.shaderProgram.use(),t.associate(this.shaderProgram),this.framebuffer.begin(),t.render(e,r),this.framebuffer.end()},e.FramebufferRenderer=o},function(t,e,r){var n=r(1).mat4,i=function(){this.stack=[],this.matrix=n.create(),n.identity(this.matrix)};i.prototype.pushMatrix=function(){var t=n.clone(this.matrix);this.stack.push(t)},i.prototype.popMatrix=function(){this.stack.length>0&&(this.matrix=this.stack.pop())},e.MatrixStack=i},function(t,e,r){var n=r(20).Buffer,i=function(t,e,r,n,i,o){this.numVertices=t,this.drawMode=e,this.buffers={},this.createBuffer("vertex",t,3,r),n&&this.createBuffer("color",t,4,n),i&&this.createBuffer("normal",t,3,i),o&&this.createBuffer("texCoord",t,2,o)};i.prototype.createBuffer=function(t,e,r,i){this.buffers[t]=new n(e,r,i),this[t+"Buffer"]=this.buffers[t]},i.prototype.associate=function(t){for(var e in this.buffers){var r=this.buffers[e],n="a"+e.charAt(0).toUpperCase()+e.slice(1),i=t.getAttribute(n);i||console.error("Could not associate "+n+" attribute"),r.associate(i)}},i.prototype.render=function(t,e){null==e&&(e=this.numVertices),gl.drawArrays(this.drawMode,t||0,e)},e.Mesh=i},function(t,e,r){var n=r(25).Mesh,i=function(t,e,r,i,o,a){n.call(this,4,gl.TRIANGLE_STRIP,r,i,o,a),this.vertexBuffer.setValues([0,0,0,0,e,0,t,0,0,t,e,0]),a&&this.texCoordBuffer.setValues([0,1,0,0,1,1,1,0])};i.prototype=Object.create(n.prototype),i.prototype.constructor=i,e.RectMesh=i},function(t,e,r){var n=r(1),i=n.vec3,o=n.quat,a=n.mat4,s=function(){this.position=i.create(),this.rotation=o.create(),this.scale=i.create(),i.set(this.scale,1,1,1)};s.prototype.apply=function(t){a.fromRotationTranslation(t,this.rotation,this.position),a.scale(t,t,this.scale)},e.Transformation=s},function(t,e,r){var n=r(1).vec3;n.limit=function(t,e,r){return n.copy(t,e),n.length(t)>r&&(n.normalize(t,t),n.scale(t,t,r)),e},n.toPolar=function(t,e){var r=t[0]=n.length(e);t[1]=Math.acos(e[2]/r),t[2]=Math.atan2(e[0],e[2])}},function(t,e,r){var n=r(1).vec3,i=r(11),o=r(30),a=function(t,e,r){this.numBoids=t,this.createBoids(e,r),this.createMesh()};a.prototype.createBoids=function(t,e){this.boids=[];for(var r=0;r<this.numBoids;r++)this.boids.push(new o(t,e))},a.prototype.createMesh=function(){this.mesh=new i.Mesh(6*(this.numBoids-1),gl.TRIANGLES,gl.STREAM_DRAW,gl.STATIC_DRAW,null,gl.STATIC_DRAW)},a.prototype.update=function(t){for(var e=0;e<this.boids.length;e++){var r=this.boids[e];r.update(this.boids,t)}},a.prototype.updateMesh=function(){for(var t=this.mesh.vertexBuffer.array,e=this.mesh.texCoordBuffer.array,r=this.mesh.colorBuffer.array,n=0,i=0,o=0,a=1;a<this.boids.length;a++){for(var s=this.boids[a],u=s.position,c=0;6>c;c++)t[n++]=u[0],t[n++]=u[1],t[n++]=u[2],r[i++]=1,r[i++]=1,r[i++]=1,r[i++]=1;e[o++]=0,e[o++]=1,e[o++]=0,e[o++]=0,e[o++]=1,e[o++]=1,e[o++]=0,e[o++]=0,e[o++]=1,e[o++]=1,e[o++]=1,e[o++]=0}this.mesh.vertexBuffer.setValues(),this.mesh.texCoordBuffer.setValues(),this.mesh.colorBuffer.setValues()},a.prototype.updateAudio=function(t){for(var e=1;e<this.boids.length;e++){var r=this.boids[e];r.updateAudio(t)}},a.prototype.center=function(){for(var t=n.create(),e=0;e<this.boids.length;e++){var r=this.boids[e];n.add(t,t,r.position)}return n.scale(t,t,1/this.boids.length),t},t.exports=a},function(t,e,r){var n=r(1).vec3,i=r(31),o=function(t,e){this.position=n.fromValues(Math.random()*t[0],Math.random()*t[1],Math.random()*t[2]),this.velocity=n.fromValues(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),n.normalize(this.velocity,this.velocity),this.acceleration=n.create(),this.centerDistance=t[2],this.avoidDistance=t[2]/8,this.matchDistance=t[2]/4,this.centerWeight=.8,this.avoidWeight=1,this.matchWeight=.8,this.steer=n.create(),this.diff=n.create(),this.sum=n.create(),this.audio=new i(e)};o.MAX_VELOCITY=600,o.MAX_FORCE=120,o.prototype.update=function(t,e){this.avoid(t),this.matchVelocity(t),this.moveToCenter(t),n.scaleAndAdd(this.velocity,this.velocity,this.acceleration,e),n.limit(this.velocity,this.velocity,o.MAX_VELOCITY),n.scaleAndAdd(this.position,this.position,this.velocity,e),n.set(this.acceleration,0,0,0)},o.prototype.updateAudio=function(t){this.audio.update(this.position,t)},o.prototype.avoid=function(t){n.set(this.steer,0,0,0);for(var e=0,r=0;r<t.length;r++){var i=t[r];if(i!=this){n.subtract(this.diff,this.position,i.position);var o=n.length(this.diff);o>this.avoidDistance||(n.normalize(this.diff,this.diff),n.scale(this.diff,this.diff,1/o),n.add(this.steer,this.steer,this.diff),e+=1)}}0!=e&&(n.scale(this.steer,this.steer,1/e),this.doSteer(this.avoidWeight))},o.prototype.matchVelocity=function(t){n.set(this.steer,0,0,0);for(var e=0,r=0;r<t.length;r++){var i=t[r];if(i!=this){n.subtract(this.diff,this.position,i.position);var o=n.length(this.diff);o>this.matchDistance||(n.add(this.steer,this.steer,i.velocity),e+=1)}}0!=e&&(n.scale(this.steer,this.steer,1/e),this.doSteer(this.matchWeight))},o.prototype.moveToCenter=function(t){n.set(this.sum,0,0,0);for(var e=0,r=0;r<t.length;r++){var i=t[r];if(i!=this){n.subtract(this.diff,this.position,i.position);var o=n.length(this.diff);o>this.centerDistance||(n.add(this.sum,this.sum,i.position),e+=1)}}0!=e&&(n.scale(this.sum,this.sum,1/e),n.set(this.steer,0,0,0),n.subtract(this.steer,this.sum,this.position),this.doSteer(this.centerWeight))},o.prototype.doSteer=function(t){0!=n.squaredLength(this.steer)&&(n.normalize(this.steer,this.steer),n.scale(this.steer,this.steer,o.MAX_VELOCITY),n.subtract(this.steer,this.steer,this.velocity),n.limit(this.steer,this.steer,o.MAX_FORCE),n.scale(this.steer,this.steer,t),n.add(this.acceleration,this.acceleration,this.steer))},t.exports=o},function(t,e,r){var n=r(1).vec3,i=r(32),o=function(t){this.sine=t.createOscillator(),this.sine.type="sine",this.sine.start(),this.pan=t.createStereoPanner(),this.gain=t.createGain(),this.gain.gain.value=0,this.sine.connect(this.pan),this.pan.connect(this.gain),this.gain.connect(t.destination)};o.prototype.update=function(t,e){var r=n.create();n.transformMat4(r,t,e);var i=n.create();n.toPolar(i,r),i[0]+=o.BASE_DISTANCE;var a=o.AMP_MULTIPLIER/(i[0]*i[0]);a=Math.min(a,o.MAX_AMP),this.gain.gain.value=a;var s=Math.floor(1.05*Math.exp(i[1]));this.sine.frequency.value=o.SCALE.getFrequency(s,o.ROOT_FREQUENCY,0),this.pan.pan.value=Math.sin(i[2])},o.MAX_AMP=1/15,o.AMP_MULTIPLIER=400,o.BASE_DISTANCE=1,o.SCALE=new i.scale.Major,o.ROOT_FREQUENCY=55,t.exports=o},function(t,e,r){e.scale=r(33),e.tuning=r(39)},function(t,e,r){e.Scale=r(34),e.Major=r(37),e.Minor=r(38)},function(t,e,r){var n=r(35),i=function(t,e){this.degrees=t,this.tuning=e||new n(12)};i.prototype.getFrequency=function(t,e,r){var n=e;return r+=Math.floor(t/this.degrees.length),t%=this.degrees.length,n*=Math.pow(this.tuning.octaveRatio,r),n*=this.tuning.ratios[this.degrees[t]]},t.exports=i},function(t,e,r){var n=r(36),i=function(t){for(var e=[],r=0;t>r;r++)e.push(r);n.call(this,e,2)};i.prototype=Object.create(n.prototype),i.prototype.constructor=n,t.exports=i},function(t,e){var r=function(t,e){this.semitones=t,this.octaveRatio=e||2,this.ratios=[];for(var r=this.semitones.length,n=0;r>n;n++)this.ratios.push(Math.pow(2,this.semitones[n]/r))};t.exports=r},function(t,e,r){var n=r(34),i=function(){n.call(this,[0,2,4,5,7,9,11])};i.prototype=Object.create(n.prototype),i.prototype.constructor=n,t.exports=i},function(t,e,r){
var n=r(34),i=function(){n.call(this,[0,2,3,5,7,8,10])};i.prototype=Object.create(n.prototype),i.prototype.constructor=n,t.exports=i},function(t,e,r){e.Tuning=r(36),e.EqualTemperament=r(35)}]);
//# sourceMappingURL=fireflies.0.2.0.min.js.map