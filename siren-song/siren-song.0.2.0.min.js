!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(1);var n=i(2),r=i(28),o=i(36),s=i(15),a=s.mat4,h=i(37),c=i(41),u=i(42),l=i(45),f=i(49),p=i(51),d=i(52),g=i(53),v=i(54),m=i(61),y=i(48);FONT_LOADED=!1,WINDOW_LOADED=!1,WebFont.load({google:{families:["Orbitron"]},active:function(){WINDOW_LOADED&&window.app.start(),FONT_LOADED=!0},inactive:function(){WINDOW_LOADED&&window.app.start(),FONT_LOADED=!0}});var w=function(t){if(n.App.call(this,t),this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,!gl)return void(document.getElementById("ui").style.display="none");this.screenWidth=screen.width,this.screenHeight=screen.height,this.shouldUpdate=!1,this.lastUpdateTime=0,this.timestep=1/60;var e=document.getElementById("basic-vert").innerHTML,i=document.getElementById("basic-frag").innerHTML;this.renderer=new n.BasicRenderer(e,i),gl.clearColor(0,0,0,0),this.projection=new n.MatrixStack,this.modelview=new n.MatrixStack,this.vec2Pool=new g(Float32Array.bind(null,2)),this.keyboard=new o,this.context=new AudioContext,this.octaveDistributor=new c,this.input=this.context.createGain(),this.delay=this.context.createDelay(),this.delay.delayTime.value=240/y.bpm,this.feedback=this.context.createGain(),this.feedback.gain.value=.7,this.delayDirty=this.context.createGain(),this.delayDirty.gain.value=.2,this.delayClean=this.context.createGain(),this.delayClean.gain.value=.8;var s=m(this.context,3,.8);this.reverb=this.context.createConvolver(),this.reverb.buffer=s,this.reverbDirty=this.context.createGain(),this.reverbDirty.gain.value=.4,this.reverbClean=this.context.createGain(),this.reverbClean.gain.value=.6,this.bitCrusher=this.context.createWaveShaper();for(var a=Math.pow(2,y.bitRate),v=new Float32Array(Math.pow(2,16)),w=v.length/a,x=0;a>x;x++)for(var M=x/(a-1)*2-1,b=0;w>b;b++)v[x*w+b]=M;this.bitCrusher.curve=v,this.input.connect(this.delay),this.delay.connect(this.feedback),this.feedback.connect(this.delay),this.delay.connect(this.delayDirty),this.input.connect(this.delayClean),this.delayClean.connect(this.reverb),this.delayDirty.connect(this.reverb),this.delayClean.connect(this.reverbClean),this.delayDirty.connect(this.reverbClean),this.reverb.connect(this.reverbDirty),this.reverbClean.connect(this.bitCrusher),this.reverbDirty.connect(this.bitCrusher),this.bitCrusher.connect(this.context.destination),this.octaveDistributor=new c,this.rootFrequency=16.352,this.scale=new r.scale.Major,this.particleSystem=new h(30),this.cloud=new u(this),this.level=new l(this),this.goodGuy=new f(this),this.sirens=[],this.chain=[this.goodGuy],this.score=new p(this),this.ui=new d(this),FONT_LOADED&&this.start(),WINDOW_LOADED=!0};w.prototype=Object.create(n.App.prototype),w.prototype.constructor=w,w.prototype.start=function(){this.goodGuy.center(),this.goodGuy.update(),this.ui.startCountdown(),requestAnimationFrame(this.draw.bind(this))},w.prototype.startUpdates=function(){this.shouldUpdate=!0,this.accum=0,this.lastUpdateTime=Date.now()},w.prototype.stopUpdates=function(){this.shouldUpdate=!1},w.prototype.handleKeys=function(){if(this.keyboard.isPressed("left")||this.keyboard.isPressed("a")){var t=y.baseTurningSpeed+y.turningSpeedMultiplier*this.score.score;this.goodGuy.particle.velocity[0]-=t}if(this.keyboard.isPressed("right")||this.keyboard.isPressed("d")){var t=y.baseTurningSpeed+y.turningSpeedMultiplier*this.score.score;this.goodGuy.particle.velocity[0]+=t}},w.prototype.addSirens=function(){Math.random()>.98&&this.sirens.push(new v(this))},w.prototype.update=function(t){this.handleKeys(),this.particleSystem.tick(t),this.level.update(t),this.addSirens();for(var e=0;e<this.sirens.length;e++)this.sirens[e].update();this.goodGuy.update(),this.cloud.update(t),this.ui.updateScore()},w.prototype.runUpdates=function(){if(this.shouldUpdate){var t=Date.now(),e=(t-this.lastUpdateTime)/1e3;for(this.lastUpdateTime=t,this.accum+=e;this.accum>=this.timestep;)this.update(this.timestep),this.accum-=this.timestep}},w.prototype.draw=function(){this.canvas.clientWidth&&this.canvas.clientHeight&&(this.canvas.width!=this.canvas.clientWidth||this.canvas.height!=this.canvas.clientHeight)&&(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight),this.runUpdates(),gl.viewport(0,0,this.canvas.width,this.canvas.height),a.ortho(this.projection.matrix,-.5,.5,.5*this.canvas.height/this.canvas.width,-.5*this.canvas.height/this.canvas.width,-1,1),this.renderer.setUniform("uProjectionMatrix",this.projection.matrix),gl.clear(gl.COLOR_BUFFER_BIT),this.renderer.setUniform("uModelviewMatrix",this.modelview.matrix),this.level.draw(),this.cloud.draw();for(var t=0;t<this.sirens.length;t++)this.sirens[t].draw();this.goodGuy.draw(),this.ui.draw(),requestAnimationFrame(this.draw.bind(this))},w.prototype.pxToLength=function(t){return t/this.widthPx()},w.prototype.lengthToPx=function(t){return t*this.widthPx()},w.prototype.width=function(){return 1},w.prototype.widthPx=function(){return this.canvas.width},w.prototype.height=function(){return this.pxToLength(this.heightPx())},w.prototype.heightPx=function(){return this.canvas.height},w.prototype.minWidth=function(){return 1},w.prototype.minWidthPx=function(){return 320},w.prototype.maxWidth=function(){return 1},w.prototype.maxWidthPx=function(){return this.screenWidth},w.prototype.minHeight=function(){return 0},w.prototype.minHeightPx=function(){return 0},w.prototype.maxHeight=function(){return this.maxHeightPx()/this.minWidthPx()},w.prototype.maxHeightPx=function(){return this.screenHeight},document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("game");window.app=new w({canvas:t,contextAttributes:{antialias:!1,alpha:!1,depth:!1}})})},function(t,e){!function(t,e,i){function n(t){return function(){return this[t]}}function r(t,e){var i=t.split("."),n=et;!(i[0]in n)&&n.execScript&&n.execScript("var "+i[0]);for(var r;i.length&&(r=i.shift());)i.length||void 0===e?n=n[r]?n[r]:n[r]={}:n[r]=e}function o(t,e,i){return t.call.apply(t.bind,arguments)}function s(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function a(t,e,i){return a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:s,a.apply(Z,arguments)}function h(t,e){this.G=t,this.v=e||t,this.z=this.v.document}function c(t,i,n){t=t.z.getElementsByTagName(i)[0],t||(t=e.documentElement),t&&t.lastChild&&t.insertBefore(n,t.lastChild)}function u(t,e){for(var i=t.className.split(/\s+/),n=0,r=i.length;r>n;n++)if(i[n]==e)return;i.push(e),t.className=i.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function l(t,e){for(var i=t.className.split(/\s+/),n=[],r=0,o=i.length;o>r;r++)i[r]!=e&&n.push(i[r]);t.className=n.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function f(t,e){for(var i=t.className.split(/\s+/),n=0,r=i.length;r>n;n++)if(i[n]==e)return Q;return tt}function p(t){var e=t.v.location.protocol;return"about:"==e&&(e=t.G.location.protocol),"https:"==e?"https:":"http:"}function d(t,e){var i=t.createElement("link",{rel:"stylesheet",href:e}),n=tt;i.onload=function(){n||(n=Q)},i.onerror=function(){n||(n=Q)},c(t,"head",i)}function g(e,i,n,r){var o=e.z.getElementsByTagName("head")[0];if(o){var s=e.createElement("script",{src:i}),a=tt;return s.onload=s.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=Q,n&&n(Z),s.onload=s.onreadystatechange=Z,"HEAD"==s.parentNode.tagName&&o.removeChild(s))},o.appendChild(s),t.setTimeout(function(){a||(a=Q,n&&n(Error("Script load timeout")))},r||5e3),s}return Z}function v(t,e,i){this.M=t,this.U=e,this.Aa=i}function m(t,e,i,n){this.d=t!=Z?t:Z,this.o=e!=Z?e:Z,this.aa=i!=Z?i:Z,this.f=n!=Z?n:Z}function y(t){t=nt.exec(t);var e=Z,i=Z,n=Z,r=Z;return t&&(t[1]!==Z&&t[1]&&(e=parseInt(t[1],10)),t[2]!==Z&&t[2]&&(i=parseInt(t[2],10)),t[3]!==Z&&t[3]&&(n=parseInt(t[3],10)),t[4]!==Z&&t[4]&&(r=/^[0-9]+$/.test(t[4])?parseInt(t[4],10):t[4])),new m(e,i,n,r)}function w(t,e,i,n,r,o,s,a,h,c,u){this.K=t,this.Ga=e,this.za=i,this.fa=n,this.Ea=r,this.ea=o,this.wa=s,this.Fa=a,this.va=h,this.da=c,this.k=u}function x(t,e){this.a=t,this.I=e}function M(t){var e=T(t.a,/(iPod|iPad|iPhone|Android|Windows Phone|BB\d{2}|BlackBerry)/,1);return""!=e?(/BB\d{2}/.test(e)&&(e="BlackBerry"),e):(t=T(t.a,/(Linux|Mac_PowerPC|Macintosh|Windows|CrOS)/,1),""!=t?("Mac_PowerPC"==t&&(t="Macintosh"),t):"Unknown")}function b(t){var e=T(t.a,/(OS X|Windows NT|Android) ([^;)]+)/,2);if(e||(e=T(t.a,/Windows Phone( OS)? ([^;)]+)/,2))||(e=T(t.a,/(iPhone )?OS ([\d_]+)/,2)))return e;if(e=T(t.a,/(?:Linux|CrOS) ([^;)]+)/,1))for(var e=e.split(/\s/),i=0;i<e.length;i+=1)if(/^[\d\._]+$/.test(e[i]))return e[i];return(t=T(t.a,/(BB\d{2}|BlackBerry).*?Version\/([^\s]*)/,2))?t:"Unknown"}function A(t){var e=M(t),i=b(t),n=y(i),r=T(t.a,/AppleWeb(?:K|k)it\/([\d\.\+]+)/,1),o=y(r),s="Unknown",a=new m,h="Unknown",c=tt;return/OPR\/[\d.]+/.test(t.a)?s="Opera":-1!=t.a.indexOf("Chrome")||-1!=t.a.indexOf("CrMo")||-1!=t.a.indexOf("CriOS")?s="Chrome":/Silk\/\d/.test(t.a)?s="Silk":"BlackBerry"==e||"Android"==e?s="BuiltinBrowser":-1!=t.a.indexOf("PhantomJS")?s="PhantomJS":-1!=t.a.indexOf("Safari")?s="Safari":-1!=t.a.indexOf("AdobeAIR")&&(s="AdobeAIR"),"BuiltinBrowser"==s?h="Unknown":"Silk"==s?h=T(t.a,/Silk\/([\d\._]+)/,1):"Chrome"==s?h=T(t.a,/(Chrome|CrMo|CriOS)\/([\d\.]+)/,2):-1!=t.a.indexOf("Version/")?h=T(t.a,/Version\/([\d\.\w]+)/,1):"AdobeAIR"==s?h=T(t.a,/AdobeAIR\/([\d\.]+)/,1):"Opera"==s?h=T(t.a,/OPR\/([\d.]+)/,1):"PhantomJS"==s&&(h=T(t.a,/PhantomJS\/([\d.]+)/,1)),a=y(h),c="AdobeAIR"==s?2<a.d||2==a.d&&5<=a.o:"BlackBerry"==e?10<=n.d:"Android"==e?2<n.d||2==n.d&&1<n.o:526<=o.d||525<=o.d&&13<=o.o,new w(s,a,h,"AppleWebKit",o,r,e,n,i,S(t.I),new v(c,536>o.d||536==o.d&&11>o.o,"iPhone"==e||"iPad"==e||"iPod"==e||"Macintosh"==e))}function T(t,e,i){return(t=t.match(e))&&t[i]?t[i]:""}function S(t){return t.documentMode?t.documentMode:void 0}function E(t){this.ua=t||"-"}function _(t,e){this.K=t,this.V=4,this.L="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.L=i[1],this.V=parseInt(i[2],10))}function R(t){return t.L+t.V}function P(t){var e=4,i="n",n=Z;return t&&((n=t.match(/(normal|oblique|italic)/i))&&n[1]&&(i=n[1].substr(0,1).toLowerCase()),(n=t.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?e=7:/[1-9]00/.test(n[1])&&(e=parseInt(n[1].substr(0,1),10)))),i+e}function F(t,e,i){this.c=t,this.h=e,this.O=i,this.j="wf",this.g=new E("-")}function C(t){l(t.h,t.g.f(t.j,"loading")),f(t.h,t.g.f(t.j,"active"))||u(t.h,t.g.f(t.j,"inactive")),O(t,"inactive")}function O(t,e,i){t.O[e]&&(i?t.O[e](i.getName(),R(i)):t.O[e]())}function D(){this.w={}}function B(t,e){this.c=t,this.C=e,this.s=this.c.createElement("span",{"aria-hidden":"true"},this.C)}function L(t,e){var i;i=[];for(var n=e.K.split(/,\s*/),r=0;r<n.length;r++){var o=n[r].replace(/['"]/g,"");-1==o.indexOf(" ")?i.push(o):i.push("'"+o+"'")}i=i.join(","),n="normal",r=e.V+"00","o"===e.L?n="oblique":"i"===e.L&&(n="italic"),t.s.style.cssText="position:absolute;top:-999px;left:-999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+i+";"+("font-style:"+n+";font-weight:"+r+";")}function I(t){c(t.c,"body",t.s)}function N(t,e,i,n,r,o,s,a){this.W=t,this.sa=e,this.c=i,this.q=n,this.C=a||"BESbswy",this.k=r,this.F={},this.T=o||5e3,this.Z=s||Z,this.B=this.A=Z,t=new B(this.c,this.C),I(t);for(var h in ot)ot.hasOwnProperty(h)&&(L(t,new _(ot[h],R(this.q))),this.F[ot[h]]=t.s.offsetWidth);t.remove()}function U(t,e,i){for(var n in ot)if(ot.hasOwnProperty(n)&&e===t.F[ot[n]]&&i===t.F[ot[n]])return Q;return tt}function k(t){var e=t.A.s.offsetWidth,i=t.B.s.offsetWidth;e===t.F.serif&&i===t.F["sans-serif"]||t.k.U&&U(t,e,i)?it()-t.xa>=t.T?t.k.U&&U(t,e,i)&&(t.Z===Z||t.Z.hasOwnProperty(t.q.getName()))?W(t,t.W):W(t,t.sa):setTimeout(a(function(){k(this)},t),25):W(t,t.W)}function W(t,e){t.A.remove(),t.B.remove(),e(t.q)}function V(t,e,i,n){this.c=e,this.t=i,this.P=0,this.ba=this.Y=tt,this.T=n,this.k=t.k}function q(t,e,i,n,r){if(0===e.length&&r)C(t.t);else for(t.P+=e.length,r&&(t.Y=r),r=0;r<e.length;r++){var o=e[r],s=i[o.getName()],h=t.t,c=o;u(h.h,h.g.f(h.j,c.getName(),R(c).toString(),"loading")),O(h,"fontloading",c),new N(a(t.ga,t),a(t.ha,t),t.c,o,t.k,t.T,n,s).start()}}function H(t){0==--t.P&&t.Y&&(t.ba?(t=t.t,l(t.h,t.g.f(t.j,"loading")),l(t.h,t.g.f(t.j,"inactive")),u(t.h,t.g.f(t.j,"active")),O(t,"active")):C(t.t))}function G(t){this.G=t,this.u=new D,this.ya=new x(t.navigator.userAgent,t.document),this.a=this.ya.parse(),this.Q=this.R=0}function Y(t,e,i){this.N=t?t:e+st,this.p=[],this.S=[],this.ca=i||""}function j(t){this.p=t,this.$=[],this.J={}}function z(t,i){this.a=new x(navigator.userAgent,e).parse(),this.c=t,this.e=i}function K(t,e){this.c=t,this.e=e,this.m=[]}function X(t,e){this.c=t,this.e=e,this.m=[]}function $(t,e){this.c=t,this.e=e,this.m=[]}function J(t,e){this.c=t,this.e=e}var Q=!0,Z=null,tt=!1,et=this,it=Date.now||function(){return+new Date};h.prototype.createElement=function(t,e,i){if(t=this.z.createElement(t),e)for(var n in e)e.hasOwnProperty(n)&&("style"==n?t.style.cssText=e[n]:t.setAttribute(n,e[n]));return i&&t.appendChild(this.z.createTextNode(i)),t},r("webfont.BrowserInfo",v),v.prototype.pa=n("M"),v.prototype.hasWebFontSupport=v.prototype.pa,v.prototype.qa=n("U"),v.prototype.hasWebKitFallbackBug=v.prototype.qa,v.prototype.ra=n("Aa"),v.prototype.hasWebKitMetricsBug=v.prototype.ra;var nt=/^([0-9]+)(?:[\._-]([0-9]+))?(?:[\._-]([0-9]+))?(?:[\._+-]?(.*))?$/;m.prototype.toString=function(){return[this.d,this.o||"",this.aa||"",this.f||""].join("")},r("webfont.UserAgent",w),w.prototype.getName=n("K"),w.prototype.getName=w.prototype.getName,w.prototype.oa=n("za"),w.prototype.getVersion=w.prototype.oa,w.prototype.ka=n("fa"),w.prototype.getEngine=w.prototype.ka,w.prototype.la=n("ea"),w.prototype.getEngineVersion=w.prototype.la,w.prototype.ma=n("wa"),w.prototype.getPlatform=w.prototype.ma,w.prototype.na=n("va"),w.prototype.getPlatformVersion=w.prototype.na,w.prototype.ja=n("da"),w.prototype.getDocumentMode=w.prototype.ja,w.prototype.ia=n("k"),w.prototype.getBrowserInfo=w.prototype.ia;var rt=new w("Unknown",new m,"Unknown","Unknown",new m,"Unknown","Unknown",new m,"Unknown",void 0,new v(tt,tt,tt));x.prototype.parse=function(){var t;if(-1!=this.a.indexOf("MSIE")||-1!=this.a.indexOf("Trident/")){t=M(this);var e=b(this),i=y(e),n=Z,r=Z,o=Z,s=Z,a=T(this.a,/Trident\/([\d\w\.]+)/,1),h=S(this.I),n=-1!=this.a.indexOf("MSIE")?T(this.a,/MSIE ([\d\w\.]+)/,1):T(this.a,/rv:([\d\w\.]+)/,1),r=y(n);""!=a?(o="Trident",s=y(a)):(o="Unknown",s=new m,a="Unknown"),t=new w("MSIE",r,n,o,s,a,t,i,e,h,new v("Windows"==t&&6<=r.d||"Windows Phone"==t&&8<=i.d,tt,tt))}else if(-1!=this.a.indexOf("Opera"))t:if(t="Unknown",e=T(this.a,/Presto\/([\d\w\.]+)/,1),i=y(e),n=b(this),r=y(n),o=S(this.I),i.d!==Z?t="Presto":(-1!=this.a.indexOf("Gecko")&&(t="Gecko"),e=T(this.a,/rv:([^\)]+)/,1),i=y(e)),-1!=this.a.indexOf("Opera Mini/"))s=T(this.a,/Opera Mini\/([\d\.]+)/,1),a=y(s),t=new w("OperaMini",a,s,t,i,e,M(this),r,n,o,new v(tt,tt,tt));else{if(-1!=this.a.indexOf("Version/")&&(s=T(this.a,/Version\/([\d\.]+)/,1),a=y(s),a.d!==Z)){t=new w("Opera",a,s,t,i,e,M(this),r,n,o,new v(10<=a.d,tt,tt));break t}s=T(this.a,/Opera[\/ ]([\d\.]+)/,1),a=y(s),t=a.d!==Z?new w("Opera",a,s,t,i,e,M(this),r,n,o,new v(10<=a.d,tt,tt)):new w("Opera",new m,"Unknown",t,i,e,M(this),r,n,o,new v(tt,tt,tt))}else/OPR\/[\d.]+/.test(this.a)?t=A(this):/AppleWeb(K|k)it/.test(this.a)?t=A(this):-1!=this.a.indexOf("Gecko")?(t="Unknown",e=new m,i="Unknown",n=b(this),r=y(n),o=tt,-1!=this.a.indexOf("Firefox")?(t="Firefox",i=T(this.a,/Firefox\/([\d\w\.]+)/,1),e=y(i),o=3<=e.d&&5<=e.o):-1!=this.a.indexOf("Mozilla")&&(t="Mozilla"),s=T(this.a,/rv:([^\)]+)/,1),a=y(s),o||(o=1<a.d||1==a.d&&9<a.o||1==a.d&&9==a.o&&2<=a.aa||s.match(/1\.9\.1b[123]/)!=Z||s.match(/1\.9\.1\.[\d\.]+/)!=Z),t=new w(t,e,i,"Gecko",a,s,M(this),r,n,S(this.I),new v(o,tt,tt))):t=rt;return t},E.prototype.f=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.ua)},_.prototype.getName=n("K"),B.prototype.remove=function(){var t=this.s;t.parentNode&&t.parentNode.removeChild(t)};var ot={Da:"serif",Ca:"sans-serif",Ba:"monospace"};N.prototype.start=function(){this.A=new B(this.c,this.C),I(this.A),this.B=new B(this.c,this.C),I(this.B),this.xa=it(),L(this.A,new _(this.q.getName()+",serif",R(this.q))),L(this.B,new _(this.q.getName()+",sans-serif",R(this.q))),k(this)},V.prototype.ga=function(t){var e=this.t;l(e.h,e.g.f(e.j,t.getName(),R(t).toString(),"loading")),l(e.h,e.g.f(e.j,t.getName(),R(t).toString(),"inactive")),u(e.h,e.g.f(e.j,t.getName(),R(t).toString(),"active")),O(e,"fontactive",t),this.ba=Q,H(this)},V.prototype.ha=function(t){var e=this.t;l(e.h,e.g.f(e.j,t.getName(),R(t).toString(),"loading")),f(e.h,e.g.f(e.j,t.getName(),R(t).toString(),"active"))||u(e.h,e.g.f(e.j,t.getName(),R(t).toString(),"inactive")),O(e,"fontinactive",t),H(this)},G.prototype.load=function(t){var e=t.context||this.G;this.c=new h(this.G,e);var e=new F(this.c,e.document.documentElement,t),i=[],n=t.timeout;u(e.h,e.g.f(e.j,"loading")),O(e,"loading");var r,i=this.u,o=this.c,s=[];for(r in t)if(t.hasOwnProperty(r)){var c=i.w[r];c&&s.push(c(t[r],o))}for(i=s,this.Q=this.R=i.length,t=new V(this.a,this.c,e,n),r=0,n=i.length;n>r;r++)o=i[r],o.H(this.a,a(this.ta,this,o,e,t))},G.prototype.ta=function(t,e,i,n){var r=this;n?t.load(function(t,e,n){var o=0==--r.R;setTimeout(function(){q(i,t,e||{},n||Z,o)},0)}):(t=0==--this.R,this.Q--,t&&0==this.Q&&C(e),q(i,[],{},Z,t))};var st="//fonts.googleapis.com/css";Y.prototype.f=function(){if(0==this.p.length)throw Error("No fonts to load!");if(-1!=this.N.indexOf("kit="))return this.N;for(var t=this.p.length,e=[],i=0;t>i;i++)e.push(this.p[i].replace(/ /g,"+"));return t=this.N+"?family="+e.join("%7C"),0<this.S.length&&(t+="&subset="+this.S.join(",")),0<this.ca.length&&(t+="&text="+encodeURIComponent(this.ca)),t};var at={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},ht={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},ct={i:"i",italic:"i",n:"n",normal:"n"},ut=RegExp("^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$");j.prototype.parse=function(){for(var t=this.p.length,e=0;t>e;e++){var i=this.p[e].split(":"),n=i[0].replace(/\+/g," "),r=["n4"];if(2<=i.length){var o,s=i[1];if(o=[],s)for(var s=s.split(","),a=s.length,h=0;a>h;h++){var c;if(c=s[h],c.match(/^[\w-]+$/)){c=ut.exec(c.toLowerCase());var u=void 0;if(c==Z)u="";else{if(u=void 0,u=c[1],u==Z||""==u)u="4";else var l=ht[u],u=l?l:isNaN(u)?"4":u.substr(0,1);u=[c[2]==Z||""==c[2]?"n":ct[c[2]],u].join("")}c=u}else c="";c&&o.push(c)}0<o.length&&(r=o),3==i.length&&(i=i[2],o=[],i=i?i.split(","):o,0<i.length&&(i=at[i[0]])&&(this.J[n]=i))}for(this.J[n]||(i=at[n])&&(this.J[n]=i),i=0;i<r.length;i+=1)this.$.push(new _(n,r[i]))}};var lt={Arimo:Q,Cousine:Q,Tinos:Q};z.prototype.H=function(t,e){e(t.k.M)},z.prototype.load=function(t){var e=this.c;if("MSIE"==this.a.getName()&&this.e.blocking!=Q){var i=a(this.X,this,t),n=function(){e.z.body?i():setTimeout(n,0)};n()}else this.X(t)},z.prototype.X=function(t){for(var e=this.c,i=new Y(this.e.api,p(e),this.e.text),n=this.e.families,r=n.length,o=0;r>o;o++){var s=n[o].split(":");3==s.length&&i.S.push(s.pop());var a="";2==s.length&&""!=s[1]&&(a=":"),i.p.push(s.join(a))}n=new j(n),n.parse(),d(e,i.f()),t(n.$,n.J,lt)},K.prototype.D=function(t){return p(this.c)+(this.e.api||"//f.fontdeck.com/s/css/js/")+(this.c.v.location.hostname||this.c.G.location.hostname)+"/"+t+".js"},K.prototype.H=function(t,e){var i=this.e.id,n=this.c.v,r=this;i?(n.__webfontfontdeckmodule__||(n.__webfontfontdeckmodule__={}),n.__webfontfontdeckmodule__[i]=function(t,i){for(var n=0,o=i.fonts.length;o>n;++n){var s=i.fonts[n];r.m.push(new _(s.name,P("font-weight:"+s.weight+";font-style:"+s.style)))}e(t)},g(this.c,this.D(i),function(t){t&&e(tt)})):e(tt)},K.prototype.load=function(t){t(this.m)},X.prototype.D=function(t){var e=p(this.c);return(this.e.api||e+"//use.typekit.net")+"/"+t+".js"},X.prototype.H=function(t,e){var i=this.e.id,n=this.e,r=this.c.v,o=this;i?(r.__webfonttypekitmodule__||(r.__webfonttypekitmodule__={}),r.__webfonttypekitmodule__[i]=function(i){i(t,n,function(t,i,n){for(var r=0;r<i.length;r+=1){var s=n[i[r]];if(s)for(var a=0;a<s.length;a+=1)o.m.push(new _(i[r],s[a]));else o.m.push(new _(i[r]))}e(t)})},g(this.c,this.D(i),function(t){t&&e(tt)},2e3)):e(tt)},X.prototype.load=function(t){t(this.m)},$.prototype.H=function(t,e){var i=this,n=i.e.projectId,r=i.e.version;if(n){var o=i.c.v;g(this.c,i.D(n,r),function(r){if(r)e(tt);else{if(o["__mti_fntLst"+n]&&(r=o["__mti_fntLst"+n]()))for(var s=0;s<r.length;s++)i.m.push(new _(r[s].fontfamily));e(t.k.M)}}).id="__MonotypeAPIScript__"+n}else e(tt)},$.prototype.D=function(t,e){var i=p(this.c),n=(this.e.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return i+"//"+n+"/"+t+".js"+(e?"?v="+e:"")},$.prototype.load=function(t){t(this.m)},J.prototype.load=function(t){var e,i,n=this.e.urls||[],r=this.e.families||[],o=this.e.testStrings||{};for(e=0,i=n.length;i>e;e++)d(this.c,n[e]);for(n=[],e=0,i=r.length;i>e;e++){var s=r[e].split(":");if(s[1])for(var a=s[1].split(","),h=0;h<a.length;h+=1)n.push(new _(s[0],a[h]));else n.push(new _(s[0]))}t(n,o)},J.prototype.H=function(t,e){return e(t.k.M)};var ft=new G(et);ft.u.w.custom=function(t,e){return new J(e,t)},ft.u.w.fontdeck=function(t,e){return new K(e,t)},ft.u.w.monotype=function(t,e){return new $(e,t)},ft.u.w.typekit=function(t,e){return new X(e,t)},ft.u.w.google=function(t,e){return new z(e,t)},et.WebFont||(et.WebFont={},et.WebFont.load=a(ft.load,ft),et.WebFontConfig&&ft.load(et.WebFontConfig))}(this,document)},function(t,e,i){e.App=i(3).App,e.Attribute=i(5).Attribute,e.BasicRenderer=i(6).BasicRenderer,e.Buffer=i(10).Buffer,e.Framebuffer=i(11).Framebuffer,e.FramebufferRenderer=i(13).FramebufferRenderer,e.MatrixStack=i(14).MatrixStack,e.Mesh=i(25).Mesh,e.RectMesh=i(26).RectMesh,e.Shader=i(8).Shader,e.ShaderProgram=i(7).ShaderProgram,e.Texture=i(12).Texture,e.Transformation=i(27).Transformation,e.Uniform=i(9).Uniform,e.glMatrix=i(15)},function(t,e,i){(function(t){var n=i(4).WebGLDebugUtils,r=function(e){e=e||{},this.canvas=e.canvas;var i=e.contextAttributes||{};try{t.gl=this.canvas.getContext("webgl",i)||this.canvas.getContext("experimental-webgl",e.contextAttributes),e.debug&&(gl=n.makeDebugContext(gl))}catch(r){gl=null}};r.prototype.updateViewport=function(){this.canvas.clientWidth&&this.canvas.clientHeight&&(this.canvas.width!=this.canvas.clientWidth||this.canvas.height!=this.canvas.clientHeight)&&(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight),gl.viewport(0,0,this.canvas.width,this.canvas.height)},r.prototype.getCanvasPosition=function(){var t=vec2.create(),e=this.canvas;do vec2[0]+=e.offsetLeft,vec2[1]+=e.offsetTop;while(e=e.offsetParent);return t},e.App=r}).call(e,function(){return this}())},function(t,e){WebGLDebugUtils=function(){function t(t){if(null==p){p={},d={};for(var e in t)"number"==typeof t[e]&&(p[t[e]]=e,d[e]=t[e])}}function e(){if(null==p)throw"WebGLDebugUtils.init(ctx) not called"}function i(t){return e(),void 0!==p[t]}function n(t){e();var i=p[t];return void 0!==i?"gl."+i:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function r(t,e,i,r){var o=f[t];if(void 0!==o){var o=o[e];if(void 0!==o&&o[i]){if("object"==typeof o[i]&&void 0!==o[i].enumBitwiseOr){for(var s=o[i].enumBitwiseOr,a=0,h=[],c=0;c<s.length;++c){var u=d[s[c]];0!==(r&u)&&(a|=u,h.push(n(u)))}return a===r?h.join(" | "):n(r)}return n(r)}}return null===r?"null":void 0===r?"undefined":r.toString()}function o(t,e){for(var i="",n=e.length,o=0;n>o;++o)i+=(0==o?"":", ")+r(t,n,o,e[o]);return i}function s(t,e,i){t.__defineGetter__(i,function(){return e[i]}),t.__defineSetter__(i,function(t){e[i]=t})}function a(e,i,o,h){function c(t,e){return function(){o&&o(e,arguments);var n=t[e].apply(t,arguments),r=h.getError();return 0!=r&&(u[r]=!0,i(r,e,arguments)),n}}h=h||e,t(e),i=i||function(t,e,i){for(var o="",s=i.length,a=0;s>a;++a)o+=(0==a?"":", ")+r(e,s,a,i[a]);l("WebGL error "+n(t)+" in "+e+"("+o+")")};var u={},f={};for(var p in e)if("function"==typeof e[p])if("getExtension"!=p)f[p]=c(e,p);else{var d=c(e,p);f[p]=function(){var t=d.apply(e,arguments);return a(t,i,o,h)}}else s(f,e,p);return f.getError=function(){for(var t in u)if(u.hasOwnProperty(t)&&u[t])return u[t]=!1,t;return e.NO_ERROR},f}function h(t){var e=t.getParameter(t.MAX_VERTEX_ATTRIBS),i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);for(var n=0;e>n;++n)t.disableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(n,0);t.deleteBuffer(i);for(var r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),n=0;r>n;++n)t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null);for(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT);t.getError(););}function c(t){function e(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}function i(t){var e=t.addEventListener;t.addEventListener=function(i,n,r){switch(i){case"webglcontextlost":A(n);break;case"webglcontextrestored":T(n);break;default:e.apply(t,arguments)}}}function n(){for(var t=Object.keys(b),e=0;e<t.length;++e)delete b[t]}function r(){++w,v||y==w&&t.loseContext()}function o(t,e){var i=t[e];return function(){if(r(),!v){var e=i.apply(t,arguments);return e}}}function a(){for(var t=0;t<m.length;++t){var e=m[t];e instanceof WebGLBuffer?l.deleteBuffer(e):e instanceof WebGLFramebuffer?l.deleteFramebuffer(e):e instanceof WebGLProgram?l.deleteProgram(e):e instanceof WebGLRenderbuffer?l.deleteRenderbuffer(e):e instanceof WebGLShader?l.deleteShader(e):e instanceof WebGLTexture&&l.deleteTexture(e)}}function c(t){return{statusMessage:t,preventDefault:function(){x=!0}}}function u(t){for(var e in t)"function"==typeof t[e]?f[e]=o(t,e):s(f,t,e);f.getError=function(){if(r(),!v)for(var t;t=l.getError();)b[t]=!0;for(var t in b)if(b[t])return delete b[t],t;return f.NO_ERROR};for(var i=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],n=0;n<i.length;++n){var a=i[n];f[a]=function(e){return function(){if(r(),v)return null;var i=e.apply(t,arguments);return i.__webglDebugContextLostId__=g,m.push(i),i}}(t[a])}for(var h=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],n=0;n<h.length;++n){var a=h[n];f[a]=function(e){return function(){return r(),v?null:e.apply(t,arguments)}}(f[a])}for(var c=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],n=0;n<c.length;++n){var a=c[n];f[a]=function(e){return function(){return r(),v?!1:e.apply(t,arguments)}}(f[a])}return f.checkFramebufferStatus=function(e){return function(){return r(),v?f.FRAMEBUFFER_UNSUPPORTED:e.apply(t,arguments)}}(f.checkFramebufferStatus),f.getAttribLocation=function(e){return function(){return r(),v?-1:e.apply(t,arguments)}}(f.getAttribLocation),f.getVertexAttribOffset=function(e){return function(){return r(),v?0:e.apply(t,arguments)}}(f.getVertexAttribOffset),f.isContextLost=function(){return v},f}var l,f,p=[],d=[],f={},g=1,v=!1,m=[],y=0,w=0,x=!1,M=0,b={};t.getContext=function(e){return function(){var i=e.apply(t,arguments);if(i instanceof WebGLRenderingContext){if(i!=l){if(l)throw"got different context";l=i,f=u(l)}return f}return i}}(t.getContext);var A=function(t){p.push(e(t))},T=function(t){d.push(e(t))};return i(t),t.loseContext=function(){if(!v){for(v=!0,y=0,++g;l.getError(););n(),b[l.CONTEXT_LOST_WEBGL]=!0;var e=c("context lost"),i=p.slice();setTimeout(function(){for(var n=0;n<i.length;++n)i[n](e);M>=0&&setTimeout(function(){t.restoreContext()},M)},0)}},t.restoreContext=function(){v&&d.length&&setTimeout(function(){if(!x)throw"can not restore. webglcontestlost listener did not call event.preventDefault";a(),h(l),v=!1,w=0,x=!1;for(var t=d.slice(),e=c("context restored"),i=0;i<t.length;++i)t[i](e)},0)},t.loseContextInNCalls=function(t){if(v)throw"You can not ask a lost contet to be lost";y=w+t},t.getNumCalls=function(){return w},t.setRestoreTimeout=function(t){M=t},t}var u=function(t){window.console&&window.console.log&&window.console.log(t)},l=function(t){window.console&&window.console.error?window.console.error(t):u(t)},f={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},
stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},p=null,d=null;return{init:t,mightBeEnum:i,glEnumToString:n,glFunctionArgToString:r,glFunctionArgsToString:o,makeDebugContext:a,makeLostContextSimulatingCanvas:c,resetToInitialState:h}}(),e.WebGLDebugUtils=WebGLDebugUtils},function(t,e){var i=function(t,e){this.size=t.size,this.type=t.type,this.name=t.name,this.location=gl.getAttribLocation(e,this.name),this.createFunctionHashes(),this.createSizeHash()};i.prototype.createFunctionHashes=function(){this.floatFunctions={},this.floatFunctions[gl.FLOAT]=gl.vertexAttrib1fv,this.floatFunctions[gl.FLOAT_VEC2]=gl.vertexAttrib2fv,this.floatFunctions[gl.FLOAT_VEC3]=gl.vertexAttrib3fv,this.floatFunctions[gl.FLOAT_VEC4]=gl.vertexAttrib4fv,this.matrixFunctions={},this.matrixFunctions[gl.FLOAT_MAT2]=gl.vertexAttrib2fv,this.matrixFunctions[gl.FLOAT_MAT3]=gl.vertexAttrib3fv,this.matrixFunctions[gl.FLOAT_MAT4]=gl.vertexAttrib4fv},i.prototype.createSizeHash=function(){this.sizes={},this.sizes[gl.FLOAT]=1,this.sizes[gl.FLOAT_VEC2]=2,this.sizes[gl.FLOAT_VEC3]=3,this.sizes[gl.FLOAT_VEC4]=4,this.sizes[gl.FLOAT_MAT2]=4,this.sizes[gl.FLOAT_MAT3]=9,this.sizes[gl.FLOAT_MAT4]=16},i.prototype.setValue=function(t){"number"==typeof t&&(t=[t]),this.floatFunctions[this.type]?this.setFloat(t):this.matrixFunctions[this.type]&&this.setMatrix(t)},i.prototype.setFloat=function(t){this.floatFunctions[this.type].apply(gl,[this.location,t])},i.prototype.setMatrix=function(t){this.matrixFunctions[this.type].apply(gl,[this.location,t])},i.prototype.setPointer=function(){gl.enableVertexAttribArray(this.location),gl.vertexAttribPointer(this.location,this.sizes[this.type],gl.FLOAT,!1,0,0)},e.Attribute=i},function(t,e,i){var n=i(7).ShaderProgram,r=function(t,e){this.shaderProgram=new n,this.shaderProgram.addShader(t,gl.VERTEX_SHADER),this.shaderProgram.addShader(e,gl.FRAGMENT_SHADER),this.shaderProgram.use()};r.prototype.render=function(t,e,i){this.shaderProgram.use(),t.associate(this.shaderProgram),t.render(e,i)},r.prototype.setUniform=function(t,e){this.shaderProgram.setUniform(t,e)},e.BasicRenderer=r},function(t,e,i){var n=i(8).Shader,r=i(5).Attribute,o=i(9).Uniform,s=function(){this.id=s.id,s.id+=1,this.program=null,this.shaders=[],this.uniforms={},this.attributes={},this.needRecompile=!0};s.id=0,s.prototype.addShader=function(t,e){var i=new n(t,e);return this.shaders.push(i),this.needRecompile=!0,i},s.prototype.removeShader=function(t){var e=this.shaders.indexOf(t);-1!=e&&this.shaders.splice(e,1),this.needRecompile=!0},s.prototype.createProgram=function(){this.program=gl.createProgram()},s.prototype.deleteProgram=function(){gl.deleteProgram(this.program)},s.prototype.attachShaders=function(){for(var t=0;t<this.shaders.length;t++){var e=this.shaders[t];gl.attachShader(this.program,e.getShader())}},s.prototype.getAttributes=function(){var t=gl.getProgramParameter(this.program,gl.ACTIVE_ATTRIBUTES);console.log("Program %d has %d active attributes",this.id,t);for(var e=0;t>e;e++){var i=gl.getActiveAttrib(this.program,e),n=new r(i,this.program);this.attributes[n.name]=n,console.log("Attribute %d: %s",e,n.name)}},s.prototype.getUniforms=function(){var t=gl.getProgramParameter(this.program,gl.ACTIVE_UNIFORMS);console.log("Program %d has %d active uniforms",this.id,t);for(var e=0;t>e;e++){var i=gl.getActiveUniform(this.program,e),n=new o(i,this.program);this.uniforms[n.name]=n,console.log("Uniform %d: %s",e,n.name)}},s.prototype.linkProgram=function(){return gl.linkProgram(this.program),gl.getProgramParameter(this.program,gl.LINK_STATUS)?!0:(console.error("Could not link shader program, %i",this.program),!1)},s.prototype.useProgram=function(){gl.useProgram(this.program)},s.prototype.use=function(){(this.needRecompile||s.activeProgram!=this.program)&&(this.needRecompile&&(null!==this.program&&this.deleteProgram(),this.createProgram(),this.attachShaders(),this.linkProgram(),this.getAttributes(),this.getUniforms(),this.needRecompile=!1),this.useProgram(),s.activeProgram=this.program)},s.prototype.getUniform=function(t){return this.uniforms[t]},s.prototype.setUniform=function(t,e){this.use(),this.uniforms[t].setValue(e)},s.prototype.getAttribute=function(t){return this.attributes[t]},s.prototype.setAttribute=function(t,e){this.use(),this.attributes[t].setValue(e)},s.activeProgram=null,e.ShaderProgram=s},function(t,e){var i=function(t,e){this.source=t,this.type=e,this.shader=gl.createShader(this.type),gl.shaderSource(this.shader,this.source),gl.compileShader(this.shader),gl.getShaderParameter(this.shader,gl.COMPILE_STATUS)||console.error("Could not compile shader ",this.name,"\n",gl.getShaderInfoLog(this.shader))};i.prototype.getShader=function(){return this.shader},e.Shader=i},function(t,e){var i=function(t,e){this.size=t.size,this.type=t.type,this.name=t.name,this.location=gl.getUniformLocation(e,this.name),this.createFunctionHashes()};i.prototype.createFunctionHashes=function(){this.floatFunctions={},this.floatFunctions[gl.FLOAT]=gl.uniform1fv,this.floatFunctions[gl.FLOAT_VEC2]=gl.uniform2fv,this.floatFunctions[gl.FLOAT_VEC3]=gl.uniform3fv,this.floatFunctions[gl.FLOAT_VEC4]=gl.uniform4fv,this.intFunctions={},this.intFunctions[gl.INT]=gl.uniform1iv,this.intFunctions[gl.INT_VEC2]=gl.uniform2iv,this.intFunctions[gl.INT_VEC3]=gl.uniform3iv,this.intFunctions[gl.INT_VEC4]=gl.uniform4iv,this.boolFunctions={},this.boolFunctions[gl.BOOL]=gl.uniform1iv,this.boolFunctions[gl.BOOL_VEC2]=gl.uniform2iv,this.boolFunctions[gl.BOOL_VEC3]=gl.uniform3iv,this.boolFunctions[gl.BOOL_VEC4]=gl.unform4iv,this.matrixFunctions={},this.matrixFunctions[gl.FLOAT_MAT2]=gl.uniformMatrix2fv,this.matrixFunctions[gl.FLOAT_MAT3]=gl.uniformMatrix3fv,this.matrixFunctions[gl.FLOAT_MAT4]=gl.uniformMatrix4fv,this.samplerFunctions={},this.samplerFunctions[gl.SAMPLER_2D]=gl.uniform1iv,this.samplerFunctions[gl.SAMPLER_CUBE]=gl.uniform1iv},i.prototype.setValue=function(t){"number"==typeof t&&(t=[t]),this.floatFunctions[this.type]?this.setFloat(t):this.intFunctions[this.type]?this.setInt(t):this.boolFunctions[this.type]?this.setBool(t):this.matrixFunctions[this.type]?this.setMatrix(t):this.samplerFunctions[this.type]&&this.setSampler(t)},i.prototype.setFloat=function(t){this.floatFunctions[this.type].apply(gl,[this.location,t])},i.prototype.setInt=function(t){this.intFunctions[this.type].apply(gl,[this.location,t])},i.prototype.setBool=function(t){this.boolFunctions[this.type].apply(gl,[this.location,t])},i.prototype.setMatrix=function(t){this.matrixFunctions[this.type].apply(gl,[this.location,!1,t])},i.prototype.setSampler=function(t){this.samplerFunctions[this.type].apply(gl,[this.location,t])},e.Uniform=i},function(t,e){var i=function(t,e,i){this.numVertices=t,this.itemSize=e,this.usage=i,this.buffer=gl.createBuffer(),this["null"](),this.array=new Float32Array(t*e)};i.prototype.getBuffer=function(){return this.buffer},i.prototype["null"]=function(){this.bind(),gl.bufferData(gl.ARRAY_BUFFER,this.numVertices*this.itemSize*4,this.usage)},i.prototype.setValues=function(t,e,i){if(e=e||0,void 0===i&&(i=t?t.length:this.array.length),0!=i){var n=this.array.subarray(e,i);t&&n.set(t),this.bind(),gl.bufferSubData(gl.ARRAY_BUFFER,0,n)}},i.prototype.bind=function(){gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer)},i.prototype.unbind=function(){gl.bindBuffer(gl.ARRAY_BUFFER,null)},i.prototype.associate=function(t){this.bind(),t.setPointer(),this.unbind()},e.Buffer=i},function(t,e,i){var n=i(12).Texture,r=function(t,e){this.width=t,this.height=e,this.framebuffer=gl.createFramebuffer(),this.begin(),this.depthBuffer=gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,this.depthBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,t,e),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,this.depthBuffer),gl.bindRenderbuffer(gl.RENDERBUFFER,null),this.end(),this.texture=new n(t,e),this.attachTexture(this.texture),this.begin(),gl.checkFramebufferStatus(gl.FRAMEBUFFER)!=gl.FRAMEBUFFER_COMPLETE&&console.error("Could not create framebuffer - error ",gl.checkFramebufferStatus(gl.FRAMEBUFFER)),this.end()};r.prototype.begin=function(t){t&&this.pushViewport(t),gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer)},r.prototype.end=function(){gl.bindFramebuffer(gl.FRAMEBUFFER,null),this.storedViewport&&this.popViewport()},r.prototype.attachTexture=function(t){this.texture=t,this.begin(),this.texture.begin(),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.texture.getTexture(),0),this.texture.end(),this.end()},r.prototype.clear=function(t){this.begin(),gl.clearColor(t[0],t[1],t[2],t[3]),gl.clear(gl.COLOR_BUFFER_BIT),this.end()},r.prototype.pushViewport=function(t){this.storedViewport=t,gl.viewport(0,0,this.width,this.height)},r.prototype.popViewport=function(){gl.viewport(this.storedViewport[0],this.storedViewport[1],this.storedViewport[2],this.storedViewport[3]),this.storedViewport=null},e.Framebuffer=r},function(t,e){var i=function(t,e){this.texture=gl.createTexture(),this.flipped=!1,this.bind(),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,t,e,0,gl.RGBA,gl.UNSIGNED_BYTE,null),this.end()};i.prototype.begin=function(t){t||(t=0),gl.activeTexture(gl.TEXTURE0+t),this.bind()},i.prototype.bind=function(){gl.bindTexture(gl.TEXTURE_2D,this.texture)},i.prototype.end=function(){gl.bindTexture(gl.TEXTURE_2D,null)},i.prototype.getTexture=function(){return this.texture},i.prototype.flipY=function(){this.flipped||(this.bind(),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),this.end(),this.flipped=!0)},i.prototype.loadFromFile=function(t){var e=new Image;e.src=t,e.onload=this.loadFromExisting.bind(this,e)},i.prototype.loadFromExisting=function(t){this.image=t,this.flipY(),this.bind(),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,this.image),this.end()},e.Texture=i},function(t,e,i){var n=i(11).Framebuffer,r=i(6).BasicRenderer,o=function(t,e,i,o){r.call(this,i,o),this.framebuffer=new n(t,e)};o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.render=function(t,e,i,n){this.shaderProgram.use(),t.associate(this.shaderProgram),this.framebuffer.begin(n),t.render(e,i),this.framebuffer.end()},e.FramebufferRenderer=o},function(t,e,i){var n=i(15).mat4,r=function(){this.stack=[],this.matrix=n.create(),n.identity(this.matrix)};r.prototype.pushMatrix=function(){var t=n.clone(this.matrix);this.stack.push(t)},r.prototype.popMatrix=function(){this.stack.length>0&&(this.matrix=this.stack.pop())},e.MatrixStack=r},function(t,e,i){e.glMatrix=i(16),e.mat2=i(17),e.mat2d=i(18),e.mat3=i(19),e.mat4=i(20),e.quat=i(21),e.vec2=i(24),e.vec3=i(22),e.vec4=i(23)},function(t,e){var i={};i.EPSILON=1e-6,i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var n=Math.PI/180;i.toRadian=function(t){return t*n},t.exports=i},function(t,e,i){var n=i(16),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*o-r*n;return s?(s=1/s,t[0]=o*s,t[1]=-n*s,t[2]=-r*s,t[3]=i*s,t):null},r.adjoint=function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],h=i[1],c=i[2],u=i[3];return t[0]=n*a+o*h,t[1]=r*a+s*h,t[2]=n*c+o*u,t[3]=r*c+s*u,t},r.mul=r.multiply,r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=n*h+o*a,t[1]=r*h+s*a,t[2]=n*-a+o*h,t[3]=r*-a+s*h,t},r.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],h=i[1];return t[0]=n*a,t[1]=r*a,t[2]=o*h,t[3]=s*h,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},t.exports=r},function(t,e,i){var n=i(16),r={};r.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],h=i*o-n*r;return h?(h=1/h,t[0]=o*h,t[1]=-n*h,t[2]=-r*h,t[3]=i*h,t[4]=(r*a-o*s)*h,t[5]=(n*s-i*a)*h,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=i[0],u=i[1],l=i[2],f=i[3],p=i[4],d=i[5];return t[0]=n*c+o*u,t[1]=r*c+s*u,t[2]=n*l+o*f,t[3]=r*l+s*f,t[4]=n*p+o*d+a,t[5]=r*p+s*d+h,t},r.mul=r.multiply,r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=Math.sin(i),u=Math.cos(i);return t[0]=n*u+o*c,t[1]=r*u+s*c,t[2]=n*-c+o*u,t[3]=r*-c+s*u,t[4]=a,t[5]=h,t},r.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=i[0],u=i[1];return t[0]=n*c,t[1]=r*c,t[2]=o*u,t[3]=s*u,t[4]=a,t[5]=h,t},r.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=i[0],u=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=n*c+o*u+a,t[5]=r*c+s*u+h,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},t.exports=r},function(t,e,i){var n=i(16),r={};r.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],h=e[6],c=e[7],u=e[8],l=u*s-a*c,f=-u*o+a*h,p=c*o-s*h,d=i*l+n*f+r*p;return d?(d=1/d,t[0]=l*d,t[1]=(-u*n+r*c)*d,t[2]=(a*n-r*s)*d,t[3]=f*d,t[4]=(u*i-r*h)*d,t[5]=(-a*i+r*o)*d,t[6]=p*d,t[7]=(-c*i+n*h)*d,t[8]=(s*i-n*o)*d,t):null},r.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],h=e[6],c=e[7],u=e[8];return t[0]=s*u-a*c,t[1]=r*c-n*u,t[2]=n*a-r*s,t[3]=a*h-o*u,t[4]=i*u-r*h,t[5]=r*o-i*a,t[6]=o*c-s*h,t[7]=n*h-i*c,t[8]=i*s-n*o,t},r.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],h=t[7],c=t[8];return e*(c*o-s*h)+i*(-c*r+s*a)+n*(h*r-o*a)},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],f=i[0],p=i[1],d=i[2],g=i[3],v=i[4],m=i[5],y=i[6],w=i[7],x=i[8];return t[0]=f*n+p*s+d*c,t[1]=f*r+p*a+d*u,t[2]=f*o+p*h+d*l,t[3]=g*n+v*s+m*c,t[4]=g*r+v*a+m*u,t[5]=g*o+v*h+m*l,t[6]=y*n+w*s+x*c,t[7]=y*r+w*a+x*u,t[8]=y*o+w*h+x*l,t},r.mul=r.multiply,r.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],f=i[0],p=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t[6]=f*n+p*s+c,t[7]=f*r+p*a+u,t[8]=f*o+p*h+l,t},r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],f=Math.sin(i),p=Math.cos(i);return t[0]=p*n+f*s,t[1]=p*r+f*a,t[2]=p*o+f*h,t[3]=p*s-f*n,t[4]=p*a-f*r,t[5]=p*h-f*o,t[6]=c,t[7]=u,t[8]=l,t},r.scale=function(t,e,i){var n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,h=r+r,c=i*s,u=n*s,l=n*a,f=r*s,p=r*a,d=r*h,g=o*s,v=o*a,m=o*h;return t[0]=1-l-d,t[3]=u-m,t[6]=f+v,t[1]=u+m,t[4]=1-c-d,t[7]=p-g,t[2]=f-v,t[5]=p+g,t[8]=1-c-l,t},r.normalFromMat4=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],h=e[6],c=e[7],u=e[8],l=e[9],f=e[10],p=e[11],d=e[12],g=e[13],v=e[14],m=e[15],y=i*a-n*s,w=i*h-r*s,x=i*c-o*s,M=n*h-r*a,b=n*c-o*a,A=r*c-o*h,T=u*g-l*d,S=u*v-f*d,E=u*m-p*d,_=l*v-f*g,R=l*m-p*g,P=f*m-p*v,F=y*P-w*R+x*_+M*E-b*S+A*T;return F?(F=1/F,t[0]=(a*P-h*R+c*_)*F,t[1]=(h*E-s*P-c*S)*F,t[2]=(s*R-a*E+c*T)*F,t[3]=(r*R-n*P-o*_)*F,t[4]=(i*P-r*E+o*S)*F,t[5]=(n*E-i*R-o*T)*F,t[6]=(g*A-v*b+m*M)*F,t[7]=(v*x-d*A-m*w)*F,t[8]=(d*b-g*x+m*y)*F,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},t.exports=r},function(t,e,i){var n=i(16),r={};r.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],h=e[6],c=e[7],u=e[8],l=e[9],f=e[10],p=e[11],d=e[12],g=e[13],v=e[14],m=e[15],y=i*a-n*s,w=i*h-r*s,x=i*c-o*s,M=n*h-r*a,b=n*c-o*a,A=r*c-o*h,T=u*g-l*d,S=u*v-f*d,E=u*m-p*d,_=l*v-f*g,R=l*m-p*g,P=f*m-p*v,F=y*P-w*R+x*_+M*E-b*S+A*T;return F?(F=1/F,t[0]=(a*P-h*R+c*_)*F,t[1]=(r*R-n*P-o*_)*F,t[2]=(g*A-v*b+m*M)*F,t[3]=(f*b-l*A-p*M)*F,t[4]=(h*E-s*P-c*S)*F,t[5]=(i*P-r*E+o*S)*F,t[6]=(v*x-d*A-m*w)*F,t[7]=(u*A-f*x+p*w)*F,t[8]=(s*R-a*E+c*T)*F,t[9]=(n*E-i*R-o*T)*F,t[10]=(d*b-g*x+m*y)*F,t[11]=(l*x-u*b-p*y)*F,t[12]=(a*S-s*_-h*T)*F,t[13]=(i*_-n*S+r*T)*F,t[14]=(g*w-d*M-v*y)*F,t[15]=(u*M-l*w+f*y)*F,t):null},r.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],h=e[6],c=e[7],u=e[8],l=e[9],f=e[10],p=e[11],d=e[12],g=e[13],v=e[14],m=e[15];return t[0]=a*(f*m-p*v)-l*(h*m-c*v)+g*(h*p-c*f),t[1]=-(n*(f*m-p*v)-l*(r*m-o*v)+g*(r*p-o*f)),t[2]=n*(h*m-c*v)-a*(r*m-o*v)+g*(r*c-o*h),t[3]=-(n*(h*p-c*f)-a*(r*p-o*f)+l*(r*c-o*h)),t[4]=-(s*(f*m-p*v)-u*(h*m-c*v)+d*(h*p-c*f)),t[5]=i*(f*m-p*v)-u*(r*m-o*v)+d*(r*p-o*f),t[6]=-(i*(h*m-c*v)-s*(r*m-o*v)+d*(r*c-o*h)),t[7]=i*(h*p-c*f)-s*(r*p-o*f)+u*(r*c-o*h),t[8]=s*(l*m-p*g)-u*(a*m-c*g)+d*(a*p-c*l),t[9]=-(i*(l*m-p*g)-u*(n*m-o*g)+d*(n*p-o*l)),t[10]=i*(a*m-c*g)-s*(n*m-o*g)+d*(n*c-o*a),t[11]=-(i*(a*p-c*l)-s*(n*p-o*l)+u*(n*c-o*a)),t[12]=-(s*(l*v-f*g)-u*(a*v-h*g)+d*(a*f-h*l)),t[13]=i*(l*v-f*g)-u*(n*v-r*g)+d*(n*f-r*l),t[14]=-(i*(a*v-h*g)-s*(n*v-r*g)+d*(n*h-r*a)),t[15]=i*(a*f-h*l)-s*(n*f-r*l)+u*(n*h-r*a),t},r.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],h=t[7],c=t[8],u=t[9],l=t[10],f=t[11],p=t[12],d=t[13],g=t[14],v=t[15],m=e*s-i*o,y=e*a-n*o,w=e*h-r*o,x=i*a-n*s,M=i*h-r*s,b=n*h-r*a,A=c*d-u*p,T=c*g-l*p,S=c*v-f*p,E=u*g-l*d,_=u*v-f*d,R=l*v-f*g;return m*R-y*_+w*E+x*S-M*T+b*A},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],f=e[9],p=e[10],d=e[11],g=e[12],v=e[13],m=e[14],y=e[15],w=i[0],x=i[1],M=i[2],b=i[3];return t[0]=w*n+x*a+M*l+b*g,t[1]=w*r+x*h+M*f+b*v,t[2]=w*o+x*c+M*p+b*m,t[3]=w*s+x*u+M*d+b*y,w=i[4],x=i[5],M=i[6],b=i[7],t[4]=w*n+x*a+M*l+b*g,t[5]=w*r+x*h+M*f+b*v,t[6]=w*o+x*c+M*p+b*m,t[7]=w*s+x*u+M*d+b*y,w=i[8],x=i[9],M=i[10],b=i[11],t[8]=w*n+x*a+M*l+b*g,t[9]=w*r+x*h+M*f+b*v,t[10]=w*o+x*c+M*p+b*m,t[11]=w*s+x*u+M*d+b*y,w=i[12],x=i[13],M=i[14],b=i[15],t[12]=w*n+x*a+M*l+b*g,t[13]=w*r+x*h+M*f+b*v,t[14]=w*o+x*c+M*p+b*m,t[15]=w*s+x*u+M*d+b*y,t},r.mul=r.multiply,r.translate=function(t,e,i){var n,r,o,s,a,h,c,u,l,f,p,d,g=i[0],v=i[1],m=i[2];return e===t?(t[12]=e[0]*g+e[4]*v+e[8]*m+e[12],t[13]=e[1]*g+e[5]*v+e[9]*m+e[13],t[14]=e[2]*g+e[6]*v+e[10]*m+e[14],t[15]=e[3]*g+e[7]*v+e[11]*m+e[15]):(n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],f=e[9],p=e[10],d=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t[6]=c,t[7]=u,t[8]=l,t[9]=f,t[10]=p,t[11]=d,t[12]=n*g+a*v+l*m+e[12],t[13]=r*g+h*v+f*m+e[13],t[14]=o*g+c*v+p*m+e[14],t[15]=s*g+u*v+d*m+e[15]),t},r.scale=function(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.rotate=function(t,e,i,r){var o,s,a,h,c,u,l,f,p,d,g,v,m,y,w,x,M,b,A,T,S,E,_,R,P=r[0],F=r[1],C=r[2],O=Math.sqrt(P*P+F*F+C*C);return Math.abs(O)<n.EPSILON?null:(O=1/O,P*=O,F*=O,C*=O,o=Math.sin(i),s=Math.cos(i),a=1-s,h=e[0],c=e[1],u=e[2],l=e[3],f=e[4],p=e[5],d=e[6],g=e[7],v=e[8],m=e[9],y=e[10],w=e[11],x=P*P*a+s,M=F*P*a+C*o,b=C*P*a-F*o,A=P*F*a-C*o,T=F*F*a+s,S=C*F*a+P*o,E=P*C*a+F*o,_=F*C*a-P*o,R=C*C*a+s,t[0]=h*x+f*M+v*b,t[1]=c*x+p*M+m*b,t[2]=u*x+d*M+y*b,t[3]=l*x+g*M+w*b,t[4]=h*A+f*T+v*S,t[5]=c*A+p*T+m*S,t[6]=u*A+d*T+y*S,t[7]=l*A+g*T+w*S,t[8]=h*E+f*_+v*R,t[9]=c*E+p*_+m*R,t[10]=u*E+d*_+y*R,t[11]=l*E+g*_+w*R,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],s=e[5],a=e[6],h=e[7],c=e[8],u=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*n,t[5]=s*r+u*n,t[6]=a*r+l*n,t[7]=h*r+f*n,t[8]=c*r-o*n,t[9]=u*r-s*n,t[10]=l*r-a*n,t[11]=f*r-h*n,t},r.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],h=e[3],c=e[8],u=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-c*n,t[1]=s*r-u*n,t[2]=a*r-l*n,t[3]=h*r-f*n,t[8]=o*n+c*r,t[9]=s*n+u*r,t[10]=a*n+l*r,t[11]=h*n+f*r,t},r.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],h=e[3],c=e[4],u=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*n,t[1]=s*r+u*n,t[2]=a*r+l*n,t[3]=h*r+f*n,t[4]=c*r-o*n,t[5]=u*r-s*n,t[6]=l*r-a*n,t[7]=f*r-h*n,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,i){var r,o,s,a=i[0],h=i[1],c=i[2],u=Math.sqrt(a*a+h*h+c*c);return Math.abs(u)<n.EPSILON?null:(u=1/u,a*=u,h*=u,c*=u,r=Math.sin(e),o=Math.cos(e),s=1-o,t[0]=a*a*s+o,t[1]=h*a*s+c*r,t[2]=c*a*s-h*r,t[3]=0,t[4]=a*h*s-c*r,t[5]=h*h*s+o,t[6]=c*h*s+a*r,t[7]=0,t[8]=a*c*s+h*r,t[9]=h*c*s-a*r,t[10]=c*c*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=n+n,h=r+r,c=o+o,u=n*a,l=n*h,f=n*c,p=r*h,d=r*c,g=o*c,v=s*a,m=s*h,y=s*c;return t[0]=1-(p+g),t[1]=l+y,t[2]=f-m,t[3]=0,t[4]=l-y,t[5]=1-(u+g),t[6]=d+v,t[7]=0,t[8]=f+m,t[9]=d-v,t[10]=1-(u+p),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},r.fromRotationTranslationScale=function(t,e,i,n){var r=e[0],o=e[1],s=e[2],a=e[3],h=r+r,c=o+o,u=s+s,l=r*h,f=r*c,p=r*u,d=o*c,g=o*u,v=s*u,m=a*h,y=a*c,w=a*u,x=n[0],M=n[1],b=n[2];return t[0]=(1-(d+v))*x,t[1]=(f+w)*x,t[2]=(p-y)*x,t[3]=0,t[4]=(f-w)*M,t[5]=(1-(l+v))*M,t[6]=(g+m)*M,t[7]=0,t[8]=(p+y)*b,t[9]=(g-m)*b,t[10]=(1-(l+d))*b,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,i,n,r){var o=e[0],s=e[1],a=e[2],h=e[3],c=o+o,u=s+s,l=a+a,f=o*c,p=o*u,d=o*l,g=s*u,v=s*l,m=a*l,y=h*c,w=h*u,x=h*l,M=n[0],b=n[1],A=n[2],T=r[0],S=r[1],E=r[2];return t[0]=(1-(g+m))*M,t[1]=(p+x)*M,t[2]=(d-w)*M,t[3]=0,t[4]=(p-x)*b,t[5]=(1-(f+m))*b,t[6]=(v+y)*b,t[7]=0,t[8]=(d+w)*A,t[9]=(v-y)*A,t[10]=(1-(f+g))*A,t[11]=0,t[12]=i[0]+T-(t[0]*T+t[4]*S+t[8]*E),t[13]=i[1]+S-(t[1]*T+t[5]*S+t[9]*E),t[14]=i[2]+E-(t[2]*T+t[6]*S+t[10]*E),t[15]=1,t},r.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,h=r+r,c=i*s,u=n*s,l=n*a,f=r*s,p=r*a,d=r*h,g=o*s,v=o*a,m=o*h;return t[0]=1-l-d,t[1]=u+m,t[2]=f-v,t[3]=0,t[4]=u-m,t[5]=1-c-d,t[6]=p+g,t[7]=0,t[8]=f+v,t[9]=p-g,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,i,n,r,o,s){var a=1/(i-e),h=1/(r-n),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*h,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(r+n)*h,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t},r.perspective=function(t,e,i,n,r){var o=1/Math.tan(e/2),s=1/(n-r);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*s,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,i,n){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),h=2/(s+a),c=2/(r+o);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((s-a)*h*.5),t[9]=(r-o)*c*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t},r.ortho=function(t,e,i,n,r,o,s){var a=1/(e-i),h=1/(n-r),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*h,t[14]=(s+o)*c,t[15]=1,t},r.lookAt=function(t,e,i,o){var s,a,h,c,u,l,f,p,d,g,v=e[0],m=e[1],y=e[2],w=o[0],x=o[1],M=o[2],b=i[0],A=i[1],T=i[2];return Math.abs(v-b)<n.EPSILON&&Math.abs(m-A)<n.EPSILON&&Math.abs(y-T)<n.EPSILON?r.identity(t):(f=v-b,p=m-A,d=y-T,g=1/Math.sqrt(f*f+p*p+d*d),f*=g,p*=g,d*=g,s=x*d-M*p,a=M*f-w*d,h=w*p-x*f,g=Math.sqrt(s*s+a*a+h*h),g?(g=1/g,s*=g,a*=g,h*=g):(s=0,a=0,h=0),c=p*h-d*a,u=d*s-f*h,l=f*a-p*s,g=Math.sqrt(c*c+u*u+l*l),g?(g=1/g,c*=g,u*=g,l*=g):(c=0,u=0,l=0),t[0]=s,t[1]=c,t[2]=f,t[3]=0,t[4]=a,t[5]=u,t[6]=p,t[7]=0,t[8]=h,t[9]=l,t[10]=d,t[11]=0,t[12]=-(s*v+a*m+h*y),t[13]=-(c*v+u*m+l*y),t[14]=-(f*v+p*m+d*y),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},t.exports=r},function(t,e,i){var n=i(16),r=i(19),o=i(22),s=i(23),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},a.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),i=o.fromValues(0,1,0);return function(n,r,s){var h=o.dot(r,s);return-.999999>h?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,i,r),o.normalize(t,t),a.setAxisAngle(n,t,Math.PI),n):h>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,r,s),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+h,a.normalize(n,n))}}(),a.setAxes=function(){var t=r.create();return function(e,i,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],a.normalize(e,a.fromMat3(e,t))}}(),a.clone=s.clone,a.fromValues=s.fromValues,a.copy=s.copy,a.set=s.set,a.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},a.setAxisAngle=function(t,e,i){i=.5*i;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t},a.add=s.add,a.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],h=i[1],c=i[2],u=i[3];return t[0]=n*u+s*a+r*c-o*h,t[1]=r*u+s*h+o*a-n*c,t[2]=o*u+s*c+n*h-r*a,t[3]=s*u-n*a-r*h-o*c,t},a.mul=a.multiply,a.scale=s.scale,a.rotateX=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=n*h+s*a,t[1]=r*h+o*a,t[2]=o*h-r*a,t[3]=s*h-n*a,t},a.rotateY=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=n*h-o*a,t[1]=r*h+s*a,t[2]=o*h+n*a,t[3]=s*h-r*a,t},a.rotateZ=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=n*h+r*a,t[1]=r*h-n*a,t[2]=o*h+s*a,t[3]=s*h-o*a,t},a.calculateW=function(t,e){var i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},a.dot=s.dot,a.lerp=s.lerp,a.slerp=function(t,e,i,n){var r,o,s,a,h,c=e[0],u=e[1],l=e[2],f=e[3],p=i[0],d=i[1],g=i[2],v=i[3];return o=c*p+u*d+l*g+f*v,0>o&&(o=-o,p=-p,d=-d,g=-g,v=-v),1-o>1e-6?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-n)*r)/s,h=Math.sin(n*r)/s):(a=1-n,h=n),t[0]=a*c+h*p,t[1]=a*u+h*d,t[2]=a*l+h*g,t[3]=a*f+h*v,t},a.sqlerp=function(){var t=a.create(),e=a.create();return function(i,n,r,o,s,h){return a.slerp(t,n,s,h),a.slerp(e,r,o,h),a.slerp(i,t,e,2*h*(1-h)),i}}(),a.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o,a=s?1/s:0;return t[0]=-i*a,t[1]=-n*a,t[2]=-r*a,t[3]=o*a,
t},a.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},a.length=s.length,a.len=a.length,a.squaredLength=s.squaredLength,a.sqrLen=a.squaredLength,a.normalize=s.normalize,a.fromMat3=function(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*o+s]-e[3*s+o])*i,t[o]=(e[3*o+r]+e[3*r+o])*i,t[s]=(e[3*s+r]+e[3*r+s])*i}return t},a.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=a},function(t,e,i){var n=i(16),r={};r.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,i){var r=new n.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=i,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],h=i[2];return t[0]=r*h-o*a,t[1]=o*s-n*h,t[2]=n*a-r*s,t},r.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t},r.hermite=function(t,e,i,n,r,o){var s=o*o,a=s*(2*o-3)+1,h=s*(o-2)+o,c=s*(o-1),u=s*(3-2*o);return t[0]=e[0]*a+i[0]*h+n[0]*c+r[0]*u,t[1]=e[1]*a+i[1]*h+n[1]*c+r[1]*u,t[2]=e[2]*a+i[2]*h+n[2]*c+r[2]*u,t},r.bezier=function(t,e,i,n,r,o){var s=1-o,a=s*s,h=o*o,c=a*s,u=3*o*a,l=3*h*s,f=h*o;return t[0]=e[0]*c+i[0]*u+n[0]*l+r[0]*f,t[1]=e[1]*c+i[1]*u+n[1]*l+r[1]*f,t[2]=e[2]*c+i[2]*u+n[2]*l+r[2]*f,t},r.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI,r=2*n.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=r*e,t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[3]*n+i[7]*r+i[11]*o+i[15];return s=s||1,t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/s,t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/s,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/s,t},r.transformMat3=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t},r.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],h=i[2],c=i[3],u=c*n+a*o-h*r,l=c*r+h*n-s*o,f=c*o+s*r-a*n,p=-s*n-a*r-h*o;return t[0]=u*c+p*-s+l*-h-f*-a,t[1]=l*c+p*-a+f*-s-u*-h,t[2]=f*c+p*-h+u*-a-l*-s,t},r.rotateX=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.rotateY=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.rotateZ=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,s){var a,h;for(i||(i=3),n||(n=0),h=r?Math.min(r*i+n,e.length):e.length,a=n;h>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),r.angle=function(t,e){var i=r.fromValues(t[0],t[1],t[2]),n=r.fromValues(e[0],e[1],e[2]);r.normalize(i,i),r.normalize(n,n);var o=r.dot(i,n);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t.exports=r},function(t,e,i){var n=i(16),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,i,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return i*i+n*n+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=i*s,t[1]=n*s,t[2]=r*s,t[3]=o*s),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2],a=e[3];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t[3]=a+n*(i[3]-a),t},r.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*s,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*s,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*s,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*s,t},r.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],h=i[2],c=i[3],u=c*n+a*o-h*r,l=c*r+h*n-s*o,f=c*o+s*r-a*n,p=-s*n-a*r-h*o;return t[0]=u*c+p*-s+l*-h-f*-a,t[1]=l*c+p*-a+f*-s-u*-h,t[2]=f*c+p*-h+u*-a-l*-s,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,s){var a,h;for(i||(i=4),n||(n=0),h=r?Math.min(r*i+n,e.length):e.length,a=n;h>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=r},function(t,e,i){var n=i(16),r={};r.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var i=new n.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,i){return t[0]=e,t[1]=i,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},r.lerp=function(t,e,i,n){var r=e[0],o=e[1];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t},r.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},r.transformMat2=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t},r.transformMat2d=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t},r.transformMat3=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,s){var a,h;for(i||(i=2),n||(n=0),h=r?Math.min(r*i+n,e.length):e.length,a=n;h>a;a+=i)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t.exports=r},function(t,e,i){var n=i(10).Buffer,r=function(t,e,i,n,r,o){this.numVertices=t,this.drawMode=e,this.buffers={},this.createBuffer("vertex",t,3,i),n&&this.createBuffer("color",t,4,n),r&&this.createBuffer("normal",t,3,r),o&&this.createBuffer("texCoord",t,2,o)};r.prototype.createBuffer=function(t,e,i,r){this.buffers[t]=new n(e,i,r),this[t+"Buffer"]=this.buffers[t]},r.prototype.associate=function(t){for(var e in this.buffers){var i=this.buffers[e],n="a"+e.charAt(0).toUpperCase()+e.slice(1),r=t.getAttribute(n);r||console.error("Could not associate "+n+" attribute"),i.associate(r)}},r.prototype.render=function(t,e){null==e&&(e=this.numVertices),gl.drawArrays(this.drawMode,t||0,e)},e.Mesh=r},function(t,e,i){var n=i(25).Mesh,r=function(t,e,i,r,o,s){n.call(this,4,gl.TRIANGLE_STRIP,i,r,o,s),this.vertexBuffer.setValues([0,0,0,0,e,0,t,0,0,t,e,0]),s&&this.texCoordBuffer.setValues([0,1,0,0,1,1,1,0])};r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.RectMesh=r},function(t,e,i){var n=i(15),r=n.vec3,o=n.quat,s=n.mat4,a=function(){this.position=r.create(),this.rotation=o.create(),this.scale=r.create(),r.set(this.scale,1,1,1)};a.prototype.apply=function(t){s.fromRotationTranslation(t,this.rotation,this.position),s.scale(t,t,this.scale)},e.Transformation=a},function(t,e,i){e.scale=i(29),e.tuning=i(35)},function(t,e,i){e.Scale=i(30),e.Major=i(33),e.Minor=i(34)},function(t,e,i){var n=i(31),r=function(t,e){this.degrees=t,this.tuning=e||new n(12)};r.prototype.getFrequency=function(t,e,i){var n=e;return i+=Math.floor(t/this.degrees.length),t%=this.degrees.length,n*=Math.pow(this.tuning.octaveRatio,i),n*=this.tuning.ratios[this.degrees[t]]},t.exports=r},function(t,e,i){var n=i(32),r=function(t){for(var e=[],i=0;t>i;i++)e.push(i);n.call(this,e,2)};r.prototype=Object.create(n.prototype),r.prototype.constructor=n,t.exports=r},function(t,e){var i=function(t,e){this.semitones=t,this.octaveRatio=e||2,this.ratios=[];for(var i=this.semitones.length,n=0;i>n;n++)this.ratios.push(Math.pow(2,this.semitones[n]/i))};t.exports=i},function(t,e,i){var n=i(30),r=function(){n.call(this,[0,2,4,5,7,9,11])};r.prototype=Object.create(n.prototype),r.prototype.constructor=n,t.exports=r},function(t,e,i){var n=i(30),r=function(){n.call(this,[0,2,3,5,7,8,10])};r.prototype=Object.create(n.prototype),r.prototype.constructor=n,t.exports=r},function(t,e,i){e.Tuning=i(32),e.EqualTemperament=i(31)},function(t,e){var i=function(t){t=t||document,t.addEventListener("keydown",this._onKeyDown.bind(this)),t.addEventListener("keyup",this._onKeyUp.bind(this)),this._keys={}};i.prototype.isPressed=function(t){return this._keys.hasOwnProperty(t)},i.prototype._onKeyDown=function(t){var e=t.which||t.keyCode,i=this._codeToKey(e);this._keys[i]=!0},i.prototype._onKeyUp=function(t){var e=t.which||t.keyCode,i=this._codeToKey(e);delete this._keys[i]},i.prototype._codeToKey=function(t){var e=i.KEYS[t],n=t-111;return n>0&&13>n&&(e="f"+n),e||(e=String.fromCharCode(t).toLowerCase()),e},i.KEYS={13:"enter",38:"up",40:"down",37:"left",39:"right",27:"esc",32:"space",8:"backspace",9:"tab",46:"delete"},t.exports=i},function(t,e,i){var n=i(38),r=i(40),o=function(){n.call(this),this.oldParticles=[],this.particles=[]};o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.createParticle=function(){var t;return t=this.oldParticles.length?this.oldParticles.pop():new r,this.particles.push(t),t},o.prototype.recycleParticle=function(t){var t=this.removeParticle(t);t.reset(),this.oldParticles.push(t)},o.prototype.recycleParticleByIndex=function(t){var e=this.removeParticleByIndex(t);e.reset(),this.oldParticles.push(e)},o.prototype.removeParticle=function(t){var e=this.particles.indexOf(t);return-1!=e?this.particles.splice(e,1)[0]:null},o.prototype.removeParticleByIndex=function(t){return t<this.particles.length?this.particles.splice(t,1)[0]:null},o.prototype.removeForce=function(t){var e=this.forces.indexOf(t);return-1!=e?this.forces.splice(e,1)[0]:null},t.exports=o},function(t,e,i){var n=i(15).vec2,r=i(39),o=function(){this.integrator=new r(this),this.particles=[],this.forces=[]};o.prototype.createParticle=function(){var t=new Particle;return this.particles.push(t),t},o.prototype.tick=function(t){this.integrator.step(t)},o.prototype.clear=function(){this.particles=[],this.forces=[]},o.prototype.applyForces=function(){for(var t=this.forces,e=t.length,i=0;e>i;i++)t[i].apply()},o.prototype.clearForces=function(){for(var t=this.particles,e=t.length,i=0;e>i;i++)n.set(t[i].force,0,0)},o.prototype.removeParticle=function(t){var e=typeof t;if("number"==e)return this.particles.splice(t,1)[0];if("object"==e){var i=this.particles.indexOf(t);if(-1!=i)return this.particles.splice(i,1)[0]}return null},o.prototype.removeForce=function(t){var e=typeof t;if("number"==e)return this.forces.splice(t,1)[0];if("object"==e){var i=this.forces.indexOf(t);if(-1!=i)return this.forces.splice(i,1)[0]}return null},t.exports=o},function(t,e){var i=function(t){this.s=t};i.prototype.step=function(t){var e=this.s;e.clearForces(),e.applyForces();for(var i=e.particles,n=i.length,r=0;n>r;r++){var o=i[r],s=o.position,a=o.velocity,h=o.force,c=o.mass;a[0]+=h[0]*t/c,a[1]+=h[1]*t/c,s[0]+=a[0]*t,s[1]+=a[1]*t,o.age+=t}},t.exports=i},function(t,e,i){var n=i(15).vec2,r=function(){this.mass=1,this.position=n.create(),this.velocity=n.create(),this.force=n.create(),this.age=0};r.prototype.toString=function(){return"position: "+this.position+"\n velocity: "+this.velocity+"\n force: "+this.force+"\n age: "+this.age},r.prototype.reset=function(){this.mass=1,n.set(this.position,0,0),n.set(this.velocity,0,0),n.set(this.force,0,0),this.age=0},t.exports=r},function(t,e){var i=function(){this.octaves=[]};i.prototype.getOctave=function(){this.octaves.length||this.octaves.push(2,3,4,5,6);var t=Math.floor(Math.random()*this.octaves.length);return this.octaves.splice(t,1)[0]},t.exports=i},function(t,e,i){var n=i(2),r=i(37),o=i(43),s=i(44),a=function(t){this.app=t,this.particleSystem=new r,this.particleSystem.integrator=new o(this.particleSystem),this.mesh=new n.Mesh(100,gl.POINTS,gl.STREAM_DRAW,gl.STREAM_DRAW)};a.prototype.update=function(t){this.particleSystem.tick(t);var e=this.app.height()/2,i=this.app.level,r=this.app.score,o=this.particleSystem,a=o.particles,h=a.length,c=s.PARTICLE_TABLE,u=c.length;h>this.mesh.numVertices&&(this.mesh=new n.Mesh(3*h,gl.POINTS,gl.STREAM_DRAW,gl.STREAM_DRAW));for(var l=this.mesh.vertexBuffer.array,f=this.mesh.colorBuffer.array,p=0,d=0,g=this.app.vec2Pool,v=g.create(),m=h-1;m>=0;m--){var y=a[m],w=y.position,x=w[0],M=w[1];i.getSides(M,v);var b=v[0],A=v[1],T=Math.floor(60*y.age),S=T&u-1,E=c[S];T>200||-e>M||M>e||b>x||x>A?(o.recycleParticleByIndex(m),r.increase(),b>x?i.setLeftColor(M,E):x>A&&i.setRightColor(M,E)):(l[p++]=x,l[p++]=M,l[p++]=0,f[d++]=E[0],f[d++]=E[1],f[d++]=E[2],f[d++]=E[3])}g.recycle(v),this.mesh.vertexBuffer.setValues(null,0,p),this.mesh.colorBuffer.setValues(null,0,d)},a.prototype.draw=function(){this.app.renderer.render(this.mesh,0,this.particleSystem.particles.length)},t.exports=a},function(t,e){var i=function(t){this.s=t};i.prototype.step=function(t){for(var e=this.s.particles,i=e.length,n=0;i>n;n++){var r=e[n],o=r.position,s=r.velocity;o[0]+=s[0]*t,o[1]+=s[1]*t,r.age+=t}},t.exports=i},function(t,e){var i={};i.hsvaToRGBA=function(t,e,i,n){if(0==e)return[i,i,i,n];var r=Math.floor(6*t),o=6*t-r,s=i*(1-e),a=i*(1-e*o),h=i*(1-e*(1-o)),r=r%6;return 0==r?[i,h,s,n]:1==r?[a,i,s,n]:2==r?[s,i,h,n]:3==r?[s,a,i,n]:4==r?[h,s,i,n]:5==r?[i,s,a,n]:void 0};var n=128;i.PARTICLE_TABLE=[];for(var r=0;n>r;r++)i.PARTICLE_TABLE.push(i.hsvaToRGBA(r/n,1,1,1));t.exports=i},function(t,e,i){var n=i(46).Noise,r=i(47),o=i(15).vec2,s=i(2),a=i(48);Math.mod=function(t,e){return(t%e+e)%e};var h=function(t){this.app=t,this.simplex=new n(Math.random()),this.resolution=2048,this.top=-this.app.maxHeight()/2,this.offset=0,this.left=new r(this.resolution),this.right=new r(this.resolution),this.leftColors=new Array(this.resolution),this.rightColors=new Array(this.resolution),this.numberOfLeftColors=0,this.numberOfRightColors=0,this.initialOffset=.27,this.offsetPerPoint=25e-7,this.minOffset=.1,this.initialSlowDeviation=.23,this.deviationPerPoint=1/6e5,this.maxSlowDeviation=.7,this.leftDetails={xOffset:-this.initialOffset,slowOffset:0,slowDeviation:this.initialSlowDeviation,slowStep:1.2,fastOffset:this.app.maxHeight(),fastDeviation:.05,fastStep:4},this.rightDetails={xOffset:this.initialOffset,slowOffset:0,slowDeviation:this.initialSlowDeviation,slowStep:1.2,fastOffset:2*this.app.maxHeight(),fastDeviation:.05,fastStep:4};for(var e=0;e<this.resolution;e++){var i=e*this.app.maxHeight()/this.resolution-this.app.maxHeight()/2;this.left.push(this.calculateSide(i,this.leftDetails)),this.right.push(this.calculateSide(i,this.rightDetails)),this.leftColors[e]=null,this.rightColors[e]=null}this.leftMesh=new s.Mesh(this.app.maxHeightPx(),gl.LINE_STRIP,gl.STREAM_DRAW,gl.STATIC_DRAW),this.rightMesh=new s.Mesh(this.app.maxHeightPx(),gl.LINE_STRIP,gl.STREAM_DRAW,gl.STATIC_DRAW),this.leftColorMesh=new s.Mesh(2*this.app.maxHeightPx(),gl.LINES,gl.STREAM_DRAW,gl.STREAM_DRAW),this.rightColorMesh=new s.Mesh(2*this.app.maxHeightPx(),gl.LINES,gl.STREAM_DRAW,gl.STREAM_DRAW),this.updateModels()};h.prototype.update=function(t){this.updateDetails(),this.addToBottom(t),this.updateModels()},h.prototype.updateDetails=function(){var t=this.app.score.score,e=this.initialOffset;e-=t*this.offsetPerPoint,e<this.minOffset&&(e=this.minOffset),this.leftDetails.xOffset=-e,this.rightDetails.xOffset=e;var i=this.initialSlowDeviation;i+=t*this.deviationPerPoint,i>this.maxSlowDeviation&&(i=this.maxSlowDeviation),this.leftDetails.slowDeviation=i,this.rightDetails.slowDeviation=i},h.prototype.addToBottom=function(t){for(this.offset+=a.velocity*t,this.top-=a.velocity*t;this.top<-this.app.maxHeight()/2;)this.left.shift(),this.right.shift(),this.left.push(this.calculateSide(this.offset+this.top+this.app.maxHeight(),this.leftDetails)),this.right.push(this.calculateSide(this.offset+this.top+this.app.maxHeight(),this.rightDetails)),this.leftColors.shift(),this.rightColors.shift(),this.leftColors.push(null),this.rightColors.push(null),this.top+=this.app.maxHeight()/this.resolution},h.prototype.updateModels=function(){for(var t=this.leftMesh.vertexBuffer.array,e=this.leftMesh.colorBuffer.array,i=this.rightMesh.vertexBuffer.array,n=this.rightMesh.colorBuffer.array,r=this.leftColorMesh.vertexBuffer.array,o=this.leftColorMesh.colorBuffer.array,s=this.rightColorMesh.vertexBuffer.array,a=this.rightColorMesh.colorBuffer.array,h=0,c=0,u=0,l=0,f=0,p=0,d=0,g=0,v=this.app.width(),m=v/2,y=this.app.heightPx(),w=-this.app.height()/2,x=this.app.vec2Pool,M=x.create(),b=Array(2),A=0;y>A;A++){var T=w+this.app.pxToLength(A);this.getSides(T,M),t[h++]=M[0],t[h++]=T,t[h++]=0,i[u++]=M[1],i[u++]=T,i[u++]=0,e[c++]=1,e[c++]=1,e[c++]=1,e[c++]=1,n[l++]=1,n[l++]=1,n[l++]=1,n[l++]=1,this.getColors(T,b);var S=b[0],E=b[1];null!=S&&(r[f++]=-m,r[f++]=T,r[f++]=0,r[f++]=M[0],r[f++]=T,r[f++]=0,o[p++]=S[0],o[p++]=S[1],o[p++]=S[2],o[p++]=S[3],o[p++]=S[0],o[p++]=S[1],o[p++]=S[2],o[8*p++ +7]=S[3]),null!=E&&(s[d++]=M[1],s[d++]=T,s[d++]=0,s[d++]=m,s[d++]=T,s[d++]=0,a[g++]=E[0],a[g++]=E[1],a[g++]=E[2],a[g++]=E[3],a[g++]=E[0],a[g++]=E[1],a[g++]=E[2],a[g++]=E[3])}x.recycle(M),this.leftMesh.vertexBuffer.setValues(null,0,h),this.leftMesh.colorBuffer.setValues(null,0,c),this.rightMesh.vertexBuffer.setValues(null,0,u),this.rightMesh.colorBuffer.setValues(null,0,l),this.leftColorMesh.vertexBuffer.setValues(null,0,f),this.leftColorMesh.colorBuffer.setValues(null,0,p),this.rightColorMesh.vertexBuffer.setValues(null,0,d),this.rightColorMesh.colorBuffer.setValues(null,0,g),this.numberOfLeftColors=f/6,this.numberOfRightColors=d/6},h.prototype.draw=function(){this.app.renderer.render(this.leftMesh,0,this.app.heightPx()),this.app.renderer.render(this.rightMesh,0,this.app.heightPx()),this.app.renderer.render(this.leftColorMesh,0,2*this.numberOfLeftColors),this.app.renderer.render(this.rightColorMesh,0,2*this.numberOfRightColors)},h.prototype.calculateSide=function(t,e){var i=0;i+=e.xOffset;var n=e.slowOffset;n+=t*e.slowStep,i+=e.slowDeviation*this.simplex.simplex2(0,n);var r=e.fastOffset;return r+=t*e.fastStep,i+=e.fastDeviation*this.simplex.simplex2(0,r)},h.prototype.getSides=function(t,e){var i=t/this.app.maxHeight()+.5,n=i*this.resolution,r=n;n=Math.floor(n),r-=n;var s=this.left.get(n),a=this.left.get(n+1)||s,h=r*a+(1-r)*s,c=this.right.get(n),u=this.right.get(n+1)||c,l=r*u+(1-r)*c;o.set(e,h,l)},h.prototype.getColors=function(t,e){var i=t/this.app.maxHeight()+.5,n=Math.floor(i*this.resolution);e[0]=this.leftColors[n],e[1]=this.rightColors[n]},h.prototype.setLeftColor=function(t,e){var i=t/this.app.maxHeight()+.5,n=Math.floor(i*this.resolution);this.leftColors[n]=e},h.prototype.setRightColor=function(t,e){var i=t/this.app.maxHeight()+.5,n=Math.floor(i*this.resolution);this.rightColors[n]=e},t.exports=h},function(t,e,i){!function(t){function e(t){function e(t,e,i){this.x=t,this.y=e,this.z=i}e.prototype.dot2=function(t,e){return this.x*t+this.y*e},e.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i},this.grad3=[new e(1,1,0),new e(-1,1,0),new e(1,-1,0),new e(-1,-1,0),new e(1,0,1),new e(-1,0,1),new e(1,0,-1),new e(-1,0,-1),new e(0,1,1),new e(0,-1,1),new e(0,1,-1),new e(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.seed(t||0)}function i(t){return t*t*t*(t*(6*t-15)+10)}function n(t,e,i){return(1-i)*t+i*e}e.prototype.seed=function(t){t>0&&1>t&&(t*=65536),t=Math.floor(t),256>t&&(t|=t<<8);for(var e=this.p,i=0;256>i;i++){var n;n=1&i?e[i]^255&t:e[i]^t>>8&255;var r=this.perm,o=this.gradP;r[i]=r[i+256]=n,o[i]=o[i+256]=this.grad3[n%12]}};var r=.5*(Math.sqrt(3)-1),o=(3-Math.sqrt(3))/6,s=1/3,a=1/6;e.prototype.simplex2=function(t,e){var i,n,s,a,h,c=(t+e)*r,u=Math.floor(t+c),l=Math.floor(e+c),f=(u+l)*o,p=t-u+f,d=e-l+f;p>d?(a=1,h=0):(a=0,h=1);var g=p-a+o,v=d-h+o,m=p-1+2*o,y=d-1+2*o;u&=255,l&=255;var w=this.perm,x=this.gradP,M=x[u+w[l]],b=x[u+a+w[l+h]],A=x[u+1+w[l+1]],T=.5-p*p-d*d;0>T?i=0:(T*=T,i=T*T*M.dot2(p,d));var S=.5-g*g-v*v;0>S?n=0:(S*=S,n=S*S*b.dot2(g,v));var E=.5-m*m-y*y;return 0>E?s=0:(E*=E,s=E*E*A.dot2(m,y)),70*(i+n+s)},e.prototype.simplex3=function(t,e,i){var n,r,o,h,c,u,l,f,p,d,g=(t+e+i)*s,v=Math.floor(t+g),m=Math.floor(e+g),y=Math.floor(i+g),w=(v+m+y)*a,x=t-v+w,M=e-m+w,b=i-y+w;x>=M?M>=b?(c=1,u=0,l=0,f=1,p=1,d=0):x>=b?(c=1,u=0,l=0,f=1,p=0,d=1):(c=0,u=0,l=1,f=1,p=0,d=1):b>M?(c=0,u=0,l=1,f=0,p=1,d=1):b>x?(c=0,u=1,l=0,f=0,p=1,d=1):(c=0,u=1,l=0,f=1,p=1,d=0);var A=x-c+a,T=M-u+a,S=b-l+a,E=x-f+2*a,_=M-p+2*a,R=b-d+2*a,P=x-1+3*a,F=M-1+3*a,C=b-1+3*a;v&=255,m&=255,y&=255;var O=this.perm,D=this.gradP,B=D[v+O[m+O[y]]],L=D[v+c+O[m+u+O[y+l]]],I=D[v+f+O[m+p+O[y+d]]],N=D[v+1+O[m+1+O[y+1]]],U=.5-x*x-M*M-b*b;0>U?n=0:(U*=U,n=U*U*B.dot3(x,M,b));var k=.5-A*A-T*T-S*S;0>k?r=0:(k*=k,r=k*k*L.dot3(A,T,S));var W=.5-E*E-_*_-R*R;0>W?o=0:(W*=W,o=W*W*I.dot3(E,_,R));var V=.5-P*P-F*F-C*C;return 0>V?h=0:(V*=V,h=V*V*N.dot3(P,F,C)),32*(n+r+o+h)},e.prototype.perlin2=function(t,e){var r=Math.floor(t),o=Math.floor(e);t-=r,e-=o,r=255&r,o=255&o;var s=this.perm,a=this.gradP,h=a[r+s[o]].dot2(t,e),c=a[r+s[o+1]].dot2(t,e-1),u=a[r+1+s[o]].dot2(t-1,e),l=a[r+1+s[o+1]].dot2(t-1,e-1),f=i(t);return n(n(h,u,f),n(c,l,f),i(e))},e.prototype.perlin3=function(t,e,r){var o=Math.floor(t),s=Math.floor(e),a=Math.floor(r);t-=o,e-=s,r-=a,o=255&o,s=255&s,a=255&a;var h=this.perm,c=this.gradP,u=c[o+h[s+h[a]]].dot3(t,e,r),l=c[o+h[s+h[a+1]]].dot3(t,e,r-1),f=c[o+h[s+1+h[a]]].dot3(t,e-1,r),p=c[o+h[s+1+h[a+1]]].dot3(t,e-1,r-1),d=c[o+1+h[s+h[a]]].dot3(t-1,e,r),g=c[o+1+h[s+h[a+1]]].dot3(t-1,e,r-1),v=c[o+1+h[s+1+h[a]]].dot3(t-1,e-1,r),m=c[o+1+h[s+1+h[a+1]]].dot3(t-1,e-1,r-1),y=i(t),w=i(e),x=i(r);return n(n(n(u,d,y),n(l,g,y),x),n(n(f,v,y),n(p,m,y),x),w)},t.Noise=e}(t.exports)},function(t,e){"use strict";function i(t){if(this._capacity=o(t),this._length=0,this._front=0,s(t)){for(var e=t.length,i=0;e>i;++i)this[i]=t[i];this._length=e}}function n(t,e,i,n,r){for(var o=0;r>o;++o)i[o+n]=t[o+e],t[o+e]=void 0}function r(t){return t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1}function o(t){if("number"!=typeof t){if(!s(t))return 16;t=t.length}return r(Math.min(Math.max(16,t),1073741824))}i.prototype.toArray=function(){for(var t=this._length,e=new Array(t),i=this._front,n=this._capacity,r=0;t>r;++r)e[r]=this[i+r&n-1];return e},i.prototype.push=function(t){var e=arguments.length,i=this._length;if(e>1){var n=this._capacity;if(i+e>n){for(var r=0;e>r;++r){this._checkCapacity(i+1);var o=this._front+i&this._capacity-1;this[o]=arguments[r],i++,this._length=i}return i}for(var o=this._front,r=0;e>r;++r)this[o+i&n-1]=arguments[r],o++;return this._length=i+e,i+e}if(0===e)return i;this._checkCapacity(i+1);var r=this._front+i&this._capacity-1;return this[r]=t,this._length=i+1,i+1},i.prototype.pop=function(){var t=this._length;if(0!==t){var e=this._front+t-1&this._capacity-1,i=this[e];return this[e]=void 0,this._length=t-1,i}},i.prototype.shift=function(){var t=this._length;if(0!==t){var e=this._front,i=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length=t-1,i}},i.prototype.unshift=function(t){var e=this._length,i=arguments.length;if(i>1){var n=this._capacity;if(e+i>n){for(var r=i-1;r>=0;r--){this._checkCapacity(e+1);var n=this._capacity,o=(this._front-1&n-1^n)-n;this[o]=arguments[r],e++,this._length=e,this._front=o}return e}for(var s=this._front,r=i-1;r>=0;r--){var o=(s-1&n-1^n)-n;this[o]=arguments[r],s=o}return this._front=s,this._length=e+i,e+i}if(0===i)return e;this._checkCapacity(e+1);var n=this._capacity,r=(this._front-1&n-1^n)-n;return this[r]=t,this._length=e+1,this._front=r,e+1},i.prototype.peekBack=function(){var t=this._length;if(0!==t){var e=this._front+t-1&this._capacity-1;return this[e]}},i.prototype.peekFront=function(){return 0!==this._length?this[this._front]:void 0},i.prototype.get=function(t){var e=t;if(e===(0|e)){var i=this._length;if(0>e&&(e+=i),!(0>e||e>=i))return this[this._front+e&this._capacity-1]}},i.prototype.isEmpty=function(){return 0===this._length},i.prototype.clear=function(){for(var t=this._length,e=this._front,i=this._capacity,n=0;t>n;++n)this[e+n&i-1]=void 0;this._length=0,this._front=0},i.prototype.toString=function(){return this.toArray().toString()},i.prototype.valueOf=i.prototype.toString,i.prototype.removeFront=i.prototype.shift,i.prototype.removeBack=i.prototype.pop,i.prototype.insertFront=i.prototype.unshift,i.prototype.insertBack=i.prototype.push,i.prototype.enqueue=i.prototype.push,i.prototype.dequeue=i.prototype.shift,i.prototype.toJSON=i.prototype.toArray,Object.defineProperty(i.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(o(1.5*this._capacity+16))},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var i=this._front,r=this._length;if(i+r>e){var o=i+r&e-1;n(this,0,this,e,o)}};var s=Array.isArray;t.exports=i},function(t,e){e.velocity=.25,e.attractionConstant=100,e.minAttractionDistance=0,e.maxAttractionDistance=.05,e.springConstant=200,e.springDampingConstant=20,e.springRestLength=.02,e.cloudParticleVelocity=.06,e.baseTurningSpeed=.005,e.turningSpeedMultiplier=7e-8,e.bpm=140,e.bitRate=6,e.countdownFontSize=72,e.scoreFontSizeLarge=36,e.scoreFontSizeSmall=20,e.scoreFontBreakWidth=600},function(t,e,i){var n=i(2),r=i(15),o=r.vec2,s=r.quat,a=i(50),h=i(44),c=function(t){this.app=t,this.numberOfPoints=100,this.radius=.02,this.springOut=null,this.particle=this.app.particleSystem.createParticle(),this.center(),this.transformation=new n.Transformation,this.angle=0,this.mesh=new n.Mesh(this.numberOfPoints,gl.LINE_STRIP,gl.STATIC_DRAW,gl.STATIC_DRAW),this.initAudioReactiveMesh(),this.initColors()};for(var u in a)c.prototype[u]=a[u];c.prototype.initColors=function(){for(var t=this.mesh.colorBuffer.array,e=1/this.numberOfPoints,i=0;i<this.numberOfPoints;i++){var n=i*e,r=h.hsvaToRGBA(n,1,1,1),o=4*i;t[o+0]=r[0],t[o+1]=r[1],t[o+2]=r[2],t[o+3]=r[3]}this.mesh.colorBuffer.setValues()},c.prototype.center=function(){var t=this.app.vec2Pool,e=t.create();this.app.level.getSides(0,e),
this.particle.position[0]=(e[0]+e[1])/2,t.recycle(e)},c.prototype.update=function(){var t=this.app.vec2Pool,e=t.create();this.app.level.getSides(0,e);var i=this.app.width(),n=this.app.height(),r=i/2,a=n/2,h=e[0],c=e[1];t.recycle(e);var u=this.particle.position[0],l=this.particle.position[1];if(-r>u||u>r||-a>l||l>a)return this.app.shouldUpdate=!1,this.particle.position[0]=(h+c)/2,this.particle.velocity[0]=0,void this.app.ui.startCountdown();(h>u||u>c)&&this.app.score.decrease(),this.handleSirenCollisions(),this.angle+=.2;var f=this.angle/2;s.set(this.transformation.rotation,Math.cos(f),Math.sin(f),0,0),o.copy(this.transformation.position,this.particle.position)},c.prototype.draw=function(){gl.lineWidth(3),this.app.modelview.pushMatrix(),this.transformation.apply(this.app.modelview.matrix),this.app.renderer.setUniform("uModelviewMatrix",this.app.modelview.matrix),this.app.renderer.render(this.mesh),this.app.modelview.popMatrix(),gl.lineWidth(1)},c.prototype.handleSirenCollisions=function(){for(var t=this.app.sirens,e=t.length,i=this.particle.position,n=this.app.vec2Pool,r=n.create(),s=0;e>s;s++){var a=t[s];if(!a.connected){o.subtract(r,i,a.particle.position);var h=o.length(r);h<this.radius+a.radius&&(a.attach(),this.app.multiplier+=1)}}n.recycle(r)},t.exports=c},function(t,e){var i={};i.initAudioReactiveMesh=function(){this.lastChannel=null,this.channelPosition=0,this.framesPerChannel=0,this.initVertices()},i.initVertices=function(){for(var t=this.mesh.vertexBuffer.array,e=2*Math.PI/(this.numberOfPoints-1),i=0;i<this.numberOfPoints;i++){var n=i*e,r=3*i;t[r+0]=this.radius*Math.sin(n),t[r+1]=this.radius*Math.cos(n),t[r+2]=0}this.mesh.vertexBuffer.setValues()},i.updateVertices=function(t){for(var e=this.mesh.vertexBuffer.array,i=2*Math.PI/(this.numberOfPoints-1),n=0,r=0;n<t.length;){var o=t[n];if(0==t[n])break;if(t[n]<0&&r>0)break;r=o,n+=1}for(var s=0;s<this.numberOfPoints;s++){var a=s*i,h=3*s,c=Math.floor((n+s)*t.length/this.numberOfPoints)%t.length,u=.1*t[c];e[h+0]=this.radius*(Math.sin(a)+u),e[h+1]=this.radius*(Math.cos(a)+u),e[h+2]=0}this.mesh.vertexBuffer.setValues()},t.exports=i},function(t,e){var i=function(t){this.app=t,this.score=0,this.highScore=0};i.prototype.increase=function(){this.score+=1,this.score>this.highScore&&(this.highScore=this.score)},i.prototype.decrease=function(){this.score=Math.floor(.995*this.score)},t.exports=i},function(t,e,i){var n=i(48),r=function(t){this.app=t,this.canvas=document.getElementById("scores"),this.context=this.canvas.getContext("2d"),this.haveShownHighScore=!1,this.countdown=3,this.countdownInterval=null,this.isCountingDown=!1,this.needDrawCountdown=!1,this.needClearCountdown=!1,this.flash=0,this.flashInterval=null,this.isFlashing=!1,this.flashOn=!1,this.needDrawFlash=!1,this.needClearFlash=!1,this.lastScore=-1,this.lastHighScore=-1};r.prototype.draw=function(){var t=this.app.score.score,e=this.app.score.highScore,i=t!=this.lastScore,r=e!=this.lastHighScore;(this.canvas.clientWidth!=this.canvas.width||this.canvas.clientHeight!=this.canvas.height)&&(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,i=!0,r=!0,this.context.shadowColor="#000000",this.context.shadowOffsetX=3,this.context.shadowOffsetY=3,this.context.textBaseline="middle");var o,s=this.canvas.width,a=s/2,h=s/3,c=this.canvas.height,u=c/2,l=4;o=this.canvas.width>n.scoreFontBreakWidth?n.scoreFontSizeLarge:n.scoreFontSizeSmall;var f=o/2,p=n.countdownFontSize,d=p/2;if(i||r||this.needDrawFlash){var g=o+"px 'Orbitron', sans-serif";this.context.font!=g&&(this.context.font=g)}if(i&&(this.context.clearRect(0,f-l,h,o+2*l),this.context.textAlign="left",this.context.fillStyle="#00FF00",this.context.fillText(t.toString(),f,o)),r&&(this.context.clearRect(2*h,f-l,h,o+2*l),this.context.textAlign="right",this.context.fillStyle="#FF0000",this.context.fillText(e.toString(),s-f,o)),(this.needDrawFlash||this.countdown)&&(this.context.textAlign="center",this.context.fillStyle="#FFFFFF"),this.needDrawFlash&&(this.context.fillText("High Score",a,o),this.needDrawFlash=!1),this.needClearFlash&&(this.context.clearRect(h,f-l,h,o+2*l),this.needClearFlash=!1),(this.needDrawCountdown||this.needClearCountdown)&&(this.context.clearRect(a-d-l,u-d-l,p+2*l,p+2*l),this.needClearCountdown=!1),this.needDrawCountdown){var g=p+"px 'Orbitron', sans-serif";this.context.font!=g&&(this.context.font=g),this.context.fillText(this.countdown.toString(),a,u),this.needDrawCountdown=!1}this.lastScore=t,this.lastHighScore=e},r.prototype.updateScore=function(){var t=this.app.score.score,e=this.app.score.highScore;t!=e||0==t||this.haveShownHighScore||(this.haveShownHighScore=!0,this.flashHighScore()),this.haveShownHighScore&&t!=e&&(this.haveShownHighScore=!1)},r.prototype.flashHighScore=function(){this.isFlashing||(this.flash=0,this.isFlashing=!0,this.flashInterval=setInterval(this.doFlashHighScore.bind(this),500))},r.prototype.doFlashHighScore=function(){this.flash+=1,this.flashOn=!this.flashOn,this.needDrawFlash=this.flashOn,this.needClearFlash=!this.flashOn,10==this.flash&&(clearInterval(this.flashInterval),this.isFlashing=!1,this.flashInterval=null)},r.prototype.startCountdown=function(){this.app.stopUpdates(),this.countdown=3,this.isCountingDown=!0,this.countdownInterval=setInterval(this.doCountdown.bind(this),1e3),this.needDrawCountdown=!0},r.prototype.doCountdown=function(){this.countdown-=1,this.needDrawCountdown=!0,0==this.countdown&&(clearInterval(this.countdownInterval),this.isCountingDown=!1,this.countdownInterval=null,this.needDrawCountdown=!1,this.needClearCountdown=!0,this.app.startUpdates())},t.exports=r},function(t,e){var i=function(t,e){this.constructor=t,this.objects=[]};i.prototype.create=function(){if(this.objects.length)var t=this.objects.pop();else var t=new this.constructor;return t},i.prototype.recycle=function(t){this.objects.push(t)},t.exports=i},function(t,e,i){var n=i(15),r=n.vec2;i(55);var o=i(56),s=i(48),a=function(t){o.call(this,t),this.phase=0,this.frequency=Math.randomBetween(-.5,.5),this.numberOfOutputs=Math.round(Math.randomBetween(1.5,10.5)),this.dTheta=2*Math.PI/this.numberOfOutputs,this.dPhase=2*this.frequency*Math.PI};a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.createParticles=function(){for(var t=0;t<this.numberOfOutputs;t++){var e=this.phase+t*this.dTheta,i=this.app.cloud.particleSystem.createParticle();r.copy(i.position,this.particle.position),i.velocity[0]=s.cloudParticleVelocity*Math.sin(e),i.velocity[1]=this.particle.velocity[1]+s.cloudParticleVelocity*Math.cos(e)}this.phase+=this.dPhase},t.exports=a},function(t,e){Math.randomBetween=function(t,e){return t+Math.random()*(e-t)}},function(t,e,i){var n=i(2),r=i(15),o=r.vec2;i(55);var s=i(50),a=i(57),h=i(58),c=i(59),u=i(60),l=i(48),f=function(t){this.app=t,this.numberOfPoints=100,this.radius=.01,this.connected=!1,this.springIn=null,this.springOut=null;var e=t.height()/2-1e-4,i=this.app.vec2Pool,r=i.create(r);this.app.level.getSides(e,r);var o=Math.randomBetween(r[0]+2*this.radius,r[1]-2*this.radius);i.recycle(r),this.particle=this.app.particleSystem.createParticle(),this.particle.position[0]=o,this.particle.position[1]=e,this.particle.velocity[1]=-l.velocity,this.transformation=new n.Transformation,this.createAttraction(),this.mesh=new n.Mesh(this.numberOfPoints,gl.LINE_STRIP,gl.STATIC_DRAW,gl.STATIC_DRAW),this.initAudioReactiveMesh(),this.initColors(),this.audio=null};for(var p in s)f.prototype[p]=s[p];f.prototype.initColors=function(){for(var t=this.mesh.colorBuffer.array,e=0;e<this.numberOfPoints;e++)t[4*e+0]=1,t[4*e+1]=1,t[4*e+2]=1,t[4*e+3]=1;this.mesh.colorBuffer.setValues()},f.prototype.createAttraction=function(){this.attraction=new a(this.app,this.app.goodGuy.particle,this.particle,l.attractionConstant,l.minAttractionDistance,l.maxAttractionDistance),this.app.particleSystem.forces.push(this.attraction)},f.prototype.removeAttraction=function(){this.app.particleSystem.removeForce(this.attraction)},f.prototype.update=function(){var t=this.particle.position,e=t[0],i=t[1],n=this.app.height(),r=n/2;if(-r>i||i>r)return void this.remove();var s=this.app.vec2Pool,a=s.create();this.app.level.getSides(i,a);var h=a[0],c=a[1];if(s.recycle(a),h>e||e>c)return void this.remove();if(o.copy(this.transformation.position,this.particle.position),this.connected){var u=this.audio.getOutputChannel();this.updateVertices(u,3),this.createParticles()}},f.prototype.draw=function(){this.app.modelview.pushMatrix(),this.transformation.apply(this.app.modelview.matrix),this.app.renderer.setUniform("uModelviewMatrix",this.app.modelview.matrix),this.app.renderer.render(this.mesh),this.app.modelview.popMatrix()},f.prototype.attach=function(){var t,e=this.app.chain,i=e[e.length-1];t=i==this.app.goodGuy?new h(this.app,i.particle,this.particle,l.springConstant,l.springDampingConstant,l.springRestLength):new u(this.app,i.particle,this.particle,l.springConstant,l.springDampingConstant,l.springRestLength),this.app.particleSystem.forces.push(t),i.springOut=t,this.springIn=t,this.connected=!0,this.removeAttraction(),this.audio=new c(this.app),e.push(this)},f.prototype.remove=function(){this.app.particleSystem.recycleParticle(this.particle);var t=this.app.sirens.indexOf(this);if(-1!=t&&this.app.sirens.splice(t,1),this.connected){this.connected=!1;var e=this.app.chain,i=e.indexOf(this),n=e[i-1],r=null;if(i!=i.length-1&&(r=e[i+1]),this.app.particleSystem.removeForce(this.springIn),this.springIn=null,n.springOut=null,r){this.app.particleSystem.removeForce(this.springOut),this.springOut=null,r.springIn=null;var o;o=n==this.app.goodGuy?new h(this.app,n.particle,r.particle,l.springConstant,l.springDampingConstant,l.springRestLength):new u(this.app,n.particle,r.particle,l.springConstant,l.springDampingConstant,l.springRestLength),this.app.particleSystem.forces.push(o),n.springOut=o,r.springIn=o}e.splice(i,1),this.audio.stop()}else this.removeAttraction()},f.prototype.createParticles=function(){},t.exports=f},function(t,e,i){var n=i(15),r=n.vec2,o=function(t,e,i,n,r,o){this.app=t,this.a=e,this.b=i,this.k=n,this.distanceMin=r,this.distanceMax=o,this.distanceMinSquared=Math.pow(this.distanceMin,2),this.distanceMaxSquared=Math.pow(this.distanceMax,2)};o.prototype.toString=function(){return"a: "+this.a+"\nb: "+this.b+"\nk: "+this.k+"\ndistanceMin "+this.distanceMin+"\ndistanceMax "+this.distanceMax},o.prototype.setMinimumDistance=function(t){this.distanceMin=t,this.distanceMinSquared=Math.pow(t,2)},o.prototype.setMaximumDistance=function(t){this.distanceMax=t,this.distanceMaxSquared=Math.pow(t,2)},o.prototype.apply=function(){var t=this.a,e=this.b,i=this.k,n=this.distanceMinSquared,o=this.distanceMaxSquared,s=this.app.vec2Pool,a=s.create();r.subtract(a,t.position,e.position);var h=r.length(a),c=Math.pow(h,2);if(o>c){n>c&&(c=n);var u=i*t.mass*e.mass/(1+c);r.scale(a,a,1+c),r.scale(a,a,u),r.add(e.force,e.force,a)}s.recycle(a)},t.exports=o},function(t,e,i){var n=i(15),r=n.vec2,o=function(t,e,i,n,r,o){this.app=t,this.a=e,this.b=i,this.springConstant=n,this.damping=r,this.restLength=o};o.prototype.toString=function(){return"a: "+this.a+"\nb: "+this.b+"\nspringConstant: "+this.springConstant+"\ndamping: "+this.damping+"\nrestLength: "+this.restLength},o.prototype.apply=function(){var t=this.a,e=this.b,i=this.restLength,n=this.springConstant,o=this.damping,s=this.app.vec2Pool,a=s.create();r.subtract(a,t.position,e.position);var h=r.length(a);0==h?r.set(a,0,0):r.scale(a,a,1/h);var c=-(h-i)*n,u=s.create();r.subtract(u,t.velocity,e.velocity);var l=-o*r.dot(a,u),f=c+l;r.scale(a,a,f),r.negate(a,a),r.add(e.force,e.force,a),s.recycle(a),s.recycle(u)},t.exports=o},function(t,e,i){var n=i(48),r=function(t){this.app=t,this.context=this.app.context,this.done=!1,this.scale=this.app.scale,this.rootFrequency=this.app.rootFrequency,this.octave=this.app.octaveDistributor.getOctave(),this.schedulerLatency=.1;var e=r.FREQUENCIES,i=Math.floor(Math.random()*e.length);this.frequencyPattern=e[i],this.frequencyIndex=0;var n=r.DURATIONS,i=Math.floor(Math.random()*n.length);this.durationPattern=n[i],this.durationIndex=0;var o=[.125,.25,.5,.75],i=Math.floor(Math.random()*o.length);this.osc=this.context.createOscillator(),this.osc.type="square",this.env=this.context.createGain(),this.osc.connect(this.env),this.env.connect(this.app.input),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=256,this.outputChannel=new Float32Array(this.analyser.fftSize),this.osc.connect(this.analyser),this.start()};r.prototype.start=function(){this.playNote(this.context.currentTime),this.env.gain.setValueAtTime(0,this.context.currentTime),this.env.gain.linearRampToValueAtTime(.1,this.context.currentTime+1),this.osc.start()},r.prototype.scheduleNote=function(){var t=this.nextNoteTime(),e=t-this.schedulerLatency,i=e-this.context.currentTime;setTimeout(this.playNote.bind(this,t),1e3*i)},r.prototype.playNote=function(t){if(!this.done){var e=this.nextFrequency();this.osc.frequency.setValueAtTime(e,t),this.lastNoteTime=t,this.scheduleNote()}},r.prototype.nextFrequency=function(){var t=this.frequencyPattern[this.frequencyIndex],e=this.scale.getFrequency(t,this.rootFrequency,this.octave);return this.frequencyIndex+=1,this.frequencyIndex%=this.frequencyPattern.length,e},r.prototype.nextNoteTime=function(){var t=this.durationPattern[this.durationIndex];return this.durationIndex+=1,this.durationIndex%=this.durationPattern.length,this.lastNoteTime+60*t/n.bpm},r.prototype.stop=function(){this.env.gain.linearRampToValueAtTime(0,this.context.currentTime+1),setTimeout(this.disconnect.bind(this),2e3)},r.prototype.disconnect=function(){this.env.disconnect(this.app.input),this.done=!0},r.prototype.getOutputChannel=function(){return this.analyser.getFloatTimeDomainData(this.outputChannel),this.outputChannel},r.DURATIONS=[[.25],[1/8]],r.FREQUENCIES=[[0,1,2],[0,1,2,3],[0,1,2,3,4,5],[0,1,2,3,4,5,6,7],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],t.exports=r},function(t,e,i){var n=i(15),r=n.vec2,o=function(t,e,i,n,r,o){this.app=t,this.a=e,this.b=i,this.springConstant=n,this.damping=r,this.restLength=o};o.prototype.toString=function(){return"a: "+this.a+"\nb: "+this.b+"\nspringConstant: "+this.springConstant+"\ndamping: "+this.damping+"\nrestLength: "+this.restLength},o.prototype.apply=function(){var t=this.a,e=this.b,i=this.restLength,n=this.springConstant,o=this.damping,s=this.app.vec2Pool,a=s.create();r.subtract(a,t.position,e.position);var h=r.length(a);0==h?r.set(a,0,0):r.scale(a,a,1/h);var c=-(h-i)*n,u=s.create();r.subtract(u,t.velocity,e.velocity);var l=-o*r.dot(a,u),f=c+l;r.scale(a,a,f),r.add(t.force,t.force,a),r.negate(a,a),r.add(e.force,e.force,a),s.recycle(a),s.recycle(u)},t.exports=o},function(t,e){t.exports=function(t,e,i){for(var n=t.createBuffer(2,e*t.sampleRate,t.sampleRate),r=n.getChannelData(0),o=n.getChannelData(1),s=0;s<r.length;s++)r[s]=(2*Math.random()-1)*Math.pow(1-s/r.length,i),o[s]=(2*Math.random()-1)*Math.pow(1-s/r.length,i);return n}}]);
//# sourceMappingURL=siren-song.0.2.0.min.js.map